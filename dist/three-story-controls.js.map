{"version":3,"file":"three-story-controls.js","sources":["../src/Damper.ts","../src/CameraRig.ts","../src/adaptors/BaseAdaptor.ts","../src/adaptors/KeyboardAdaptor.ts","../src/adaptors/PointerAdaptor.ts","../src/adaptors/ScrollAdaptor.ts","../src/adaptors/SwipeAdaptor.ts","../src/adaptors/WheelAdaptor.ts","../src/controlschemes/FreeMovementControls.ts","../src/controlschemes/ScrollControls.ts","../src/controlschemes/StoryPointsControls.ts","../src/controlschemes/PathPointsControls.ts","../src/controlschemes/ThreeDOFControls.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/camerahelper/index.ts"],"sourcesContent":["export interface DamperValues {\n  /** A value to dampen, set to its initial state  */\n  [key: string]: number | null\n}\n\nexport interface DamperProps {\n  /**  Values to be dampened */\n  values: DamperValues\n  /** Multiplier used on each update to approach the target value, should be between 0 and 1, where 1 is no damping */\n  dampingFactor: number\n  /** Amount of permitted error before a value is considered to have 'reached' its target. Defaults to 0.001 */\n  epsilon?: number\n}\n\n/**\n * Damper uses simple linear damping for a given collection of values.\n * On every call to update, the damper will approach a given set of target values.\n * @example\n * ```js\n * const damper = new Damper({\n *  values: {x: 0, y: 0},\n *  dampingFactor: 0.4\n * })\n *\n * damper.setTarget({ x: 1, y: 100 })\n * damper.update() // would generally be called in an animation loop\n * const values = damper.getCurrentValues() // values.x = 0.4; values.y = 40\n * ```\n */\n\nexport class Damper {\n  private dampingFactor: number\n  private epsilon = 0.001\n  private values: DamperValues = {}\n  private targetValues: DamperValues = {}\n  private deltaValues: DamperValues = {}\n  private hasReached: boolean\n\n  constructor(props: DamperProps) {\n    Object.assign(this.values, props.values)\n    Object.assign(this.targetValues, props.values)\n    this.deltaValues = {}\n    for (const key in this.values) {\n      this.deltaValues[key] = 0\n    }\n    this.dampingFactor = props.dampingFactor\n    if (props.epsilon) this.epsilon = props.epsilon\n    this.hasReached = true\n  }\n\n  /**\n   * Update the damper, should generally be called on every frame\n   */\n  update(): void {\n    const deltas = {}\n    let approached = true\n\n    for (const key in this.values) {\n      deltas[key] = this.targetValues[key] - this.values[key]\n      approached = approached && Math.abs(deltas[key]) < this.epsilon\n    }\n\n    if (approached) {\n      for (const key in this.values) {\n        this.deltaValues[key] = deltas[key]\n        this.values[key] = this.targetValues[key]\n      }\n      this.hasReached = true\n    } else {\n      for (const key in this.values) {\n        this.deltaValues[key] = this.dampingFactor * deltas[key]\n        this.values[key] += this.deltaValues[key]\n      }\n    }\n  }\n\n  /**\n   * Set the target values the damper needs to approach\n   * @param target DamperValues the damper needs to approach\n   */\n  setTarget(target: DamperValues): void {\n    for (const key in target) {\n      this.targetValues[key] = target[key]\n    }\n    this.hasReached = false\n  }\n\n  /**\n   * Increment/Decrement a specifc damper target value\n   * @param key The key of the value to modify\n   * @param value The amount to modify the target by\n   */\n  addToTarget(key: string, value: number): void {\n    this.targetValues[key] += value\n    this.hasReached = false\n  }\n\n  /**\n   * Reset all damper values to the fiven number\n   * @param value Number to reset all damper values to\n   */\n  resetAll(value: number): void {\n    for (const key in this.values) {\n      this.targetValues[key] = value\n      this.values[key] = value\n      this.deltaValues[key] = 0\n    }\n    this.hasReached = true\n  }\n\n  /**\n   * Reset damper values as described by the given DamperValues object\n   * @param values DamperValues object to reset the damper to\n   */\n  resetData(values: DamperValues): void {\n    for (const key in values) {\n      this.targetValues[key] = values[key]\n      this.values[key] = values[key]\n      this.deltaValues[key] = 0\n    }\n    this.hasReached = true\n  }\n\n  /**\n   * Get the current values\n   * @returns DamperValues object with the current values of the damper\n   */\n  getCurrentValues(): DamperValues {\n    return { ...this.values }\n  }\n\n  /**\n   * Get the change in values since the last update call\n   * @returns DamperValues object with the amount the values changed since the last `update()` call\n   */\n  getDeltaValues(): DamperValues {\n    return { ...this.deltaValues }\n  }\n\n  /**\n   * Whether the damper has reached its target\n   * @returns Whether the damper has reached its target (within permissible error range)\n   */\n  reachedTarget(): boolean {\n    return this.hasReached\n  }\n}\n","import {\n  Vector3,\n  Quaternion,\n  Object3D,\n  Camera,\n  PerspectiveCamera,\n  Scene,\n  AnimationMixer,\n  AnimationClip,\n  EventDispatcher,\n  Euler,\n} from 'three'\n\nimport gsap from 'gsap'\n\n/**\n * Event: Fired when CameraRig starts a transition\n * @example\n * ```javascript\n * rig.addEventListener('CameraMoveStart', handlerFunction)\n * ```\n * */\nexport interface CameraMoveStartEvent {\n  type: 'CameraMoveStart'\n}\n\n/**\n * Event: Fired on every tick of CameraRig's transition\n * @example\n * ```javascript\n * rig.addEventListener('CameraMoveUpdate', handlerFunction)\n * ```\n * */\nexport interface CameraMoveUpdateEvent {\n  type: 'CameraMoveUpdate'\n  /** Percentage of transition completed, between 0 and 1. */\n  progress: number\n}\n\n/**\n * Event: Fired when CameraRig ends a transition\n * @example\n * ```javascript\n * rig.addEventListener('CameraMoveEnd', handlerFunction)\n * ```\n * */\nexport interface CameraMoveEndEvent {\n  type: 'CameraMoveEnd'\n}\n\n/**\n * Enum of camera actions used to control a {@link three-story-controls#CameraRig}\n */\nexport enum CameraAction {\n  Pan = 'Pan',\n  Tilt = 'Tilt',\n  Roll = 'Roll',\n  Truck = 'Truck',\n  Pedestal = 'Pedestal',\n  Dolly = 'Dolly',\n  Zoom = 'Zoom',\n}\n\n/**\n * Enum of {@link three-story-controls#CameraRig} parts\n */\nexport enum RigComponent {\n  Body = 'body',\n  Head = 'head',\n  Eyes = 'eyes',\n}\n\n/**\n * Enum of axes\n */\nexport enum Axis {\n  X = 'x',\n  Y = 'y',\n  Z = 'z',\n}\n\n/**\n * Describe whether rig should translate along current rotation in each action axis\n */\nexport interface TranslateGuide {\n  [CameraAction.Pan]: boolean\n  [CameraAction.Tilt]: boolean\n  [CameraAction.Roll]: boolean\n}\n\n/**\n * Mapping of rotation action to axis\n */\nexport interface ActionAxes {\n  [CameraAction.Pan]: Axis\n  [CameraAction.Tilt]: Axis\n  [CameraAction.Roll]: Axis\n}\n\nconst AxisVector = {\n  [Axis.X]: new Vector3(1, 0, 0),\n  [Axis.Y]: new Vector3(0, 1, 0),\n  [Axis.Z]: new Vector3(0, 0, 1),\n}\n\nconst ActionMappingByUpAxis = {\n  [Axis.X]: {\n    [CameraAction.Pan]: Axis.X,\n    [CameraAction.Tilt]: Axis.Z,\n    [CameraAction.Roll]: Axis.Y,\n  },\n  [Axis.Y]: {\n    [CameraAction.Pan]: Axis.Y,\n    [CameraAction.Tilt]: Axis.X,\n    [CameraAction.Roll]: Axis.Z,\n  },\n  [Axis.Z]: {\n    [CameraAction.Pan]: Axis.Z,\n    [CameraAction.Tilt]: Axis.Y,\n    [CameraAction.Roll]: Axis.X,\n  },\n}\n\n/**\n * The CameraRig holds the camera, and can respond to {@link three-story-controls#CameraAction}s such as Pan/Tilt/Dolly etc. It can also be controlled along a given path (in the form of an `AnimationClip`), or tweened to specified points.\n *\n * @remarks\n * The rig is constructed of three objects, analagous to a body, head and eyes. The camera is nested in the eyes and is never transformed directly.\n *\n * Instead of specifying the axis to rotate/translate the camera, {@link three-story-controls#CameraAction}s are used. The rotation order of actions is always `Pan` then `Tilt` then `Roll`.\n * The mapping of these actions to axes depends on the up axis, which defaults to `Y` (but can be changed with the {@link CameraRig.setUpAxis | setUpAxis() method}):\n *\n * * `CameraAction.Pan` rotates around the `Y` axis\n *\n * * `CameraAction.Tilt` rotates around the `X` axis\n *\n * * `CameraAction.Roll` rotates around the `Z` axis\n *\n * * `CameraAction.Dolly` translates on the `Z` axis\n *\n * * `CameraAction.Truck` translates on the `X` axis\n *\n * * `CameraAction.Pedestal` translates on the `Y` axis\n *\n * Translations will be applied to the 'body' of the rig, and rotations to the 'eyes'. If an animation clip is provided, or the camera is tweened to a specific location,\n * the rotations will be applied to the 'head', thus leaving the 'eyes' free to 'look around' from this base position.\n *\n * Additionally, the default setup assumes that the rig will move forward/backward (`Dolly`) in the direction the camera is panned to.\n * This can be configured through {@link CameraRig.translateAlong | translateAlong property}.\n * It can also be overwritten by providing the component name to the {@link CameraRig.do | do() method}, see {@link https://github.com/nytimes/three-story-controls/blob/main/src/controlschemes/ThreeDOFControls.ts#L96 | ThreeDOFControls implementation} for an example.\n *\n * To move the rig along a specified path, use the {@link CameraRig.setAnimationClip | setAnimationClip() method},\n *  and set the names for the `Translation` and `Rotation` objects to match those of the clip. The clip should have a `VectorKeyframeTrack` for the outer position/translation object,\n *  and a `QuaternionKeyframeTrack` for the inner orientation/rotation object.\n *\n * See {@link three-story-controls#CameraMoveStartEvent}, {@link three-story-controls#CameraMoveUpdateEvent} and {@link three-story-controls#CameraMoveEndEvent} for emitted event signatures.\n */\nexport class CameraRig extends EventDispatcher {\n  readonly camera: Camera\n  readonly scene: Scene\n  private body: Object3D\n  private head: Object3D\n  private eyes: Object3D\n  private cameraIsInRig: boolean\n  private inTransit = false\n  private upAxis: Axis = Axis.Y\n  private actionAxes: ActionAxes = ActionMappingByUpAxis[this.upAxis]\n  private hasAnimation = false\n  private animationClip: AnimationClip\n  private mixer: AnimationMixer\n  private animationTranslationObjectName = 'Translation'\n  private animationRotationObjectName = 'Rotation'\n\n  public translateAlong: TranslateGuide = {\n    [CameraAction.Tilt]: false,\n    [CameraAction.Pan]: true,\n    [CameraAction.Roll]: false,\n  }\n\n  // Constructor\n  constructor(camera: Camera, scene: Scene) {\n    super()\n    this.camera = camera\n    this.scene = scene\n    this.body = new Object3D()\n    this.head = new Object3D()\n    this.eyes = new Object3D()\n    this.head.name = this.animationRotationObjectName\n    this.body.name = this.animationTranslationObjectName\n    this.body.rotation.order = this.getRotationOrder()\n    this.head.rotation.order = this.getRotationOrder()\n    this.eyes.rotation.order = this.getRotationOrder()\n    this.scene.add(this.body.add(this.head.add(this.eyes.add(this.camera))))\n    this.cameraIsInRig = true\n    this.unpackTransform()\n  }\n\n  /**\n   * Get the axis for a given action\n   * @param action\n   * @returns x | y | z\n   */\n  getAxisFor(action: CameraAction): string {\n    return this.actionAxes[action]\n  }\n\n  /**\n   * Get the axis' vector for a given action\n   * @param action\n   * @returns Normalized vector for the axis\n   */\n  getAxisVectorFor(action: CameraAction): Vector3 {\n    return AxisVector[this.actionAxes[action]]\n  }\n\n  /**\n   * Main method for controlling the camera\n   * @param action - Action to perform\n   * @param amount - Amount to move/rotate/etc\n   * @param rigComponent - Override the default component to perform the action on\n   */\n  do(action: CameraAction, amount: number, rigComponent?: RigComponent): void {\n    const targetComponent = this[rigComponent]\n\n    switch (action) {\n      case CameraAction.Pan:\n      case CameraAction.Tilt:\n      case CameraAction.Roll: {\n        const axis = this.getAxisVectorFor(action)\n        if (targetComponent) {\n          targetComponent.rotateOnAxis(axis, amount)\n        } else if (this.translateAlong[action]) {\n          this.body.rotateOnAxis(axis, amount)\n        } else {\n          this.eyes.rotateOnAxis(axis, amount)\n        }\n        break\n      }\n\n      case CameraAction.Truck: {\n        const axis = this.getAxisVectorFor(CameraAction.Tilt)\n        const component = targetComponent || this.body\n        component.translateOnAxis(axis, amount)\n        break\n      }\n\n      case CameraAction.Pedestal: {\n        const axis = this.getAxisVectorFor(CameraAction.Pan)\n        const component = targetComponent || this.body\n        component.translateOnAxis(axis, amount)\n        break\n      }\n\n      case CameraAction.Dolly: {\n        const axis = this.getAxisVectorFor(CameraAction.Roll)\n        const component = targetComponent || this.body\n        component.translateOnAxis(axis, amount)\n        break\n      }\n\n      case CameraAction.Zoom: {\n        if (this.camera instanceof PerspectiveCamera) {\n          this.camera.fov = amount\n          this.camera.updateProjectionMatrix()\n        }\n        break\n      }\n\n      default:\n        break\n    }\n  }\n\n  /**\n   * Get world position and orientation of the camera\n   */\n  getWorldCoordinates(): { position: Vector3; quaternion: Quaternion } {\n    const position = new Vector3()\n    this.camera.getWorldPosition(position)\n    const quaternion = new Quaternion()\n    this.camera.getWorldQuaternion(quaternion)\n    return { position, quaternion }\n  }\n\n  /**\n   * Sets world coordinates for the camera, and configures rig component transforms accordingly.\n   * @param param0\n   */\n  setWorldCoordinates({ position, quaternion }: { position: Vector3; quaternion: Quaternion }): void {\n    const currentRotation = new Euler().setFromQuaternion(quaternion, this.getRotationOrder())\n    const actions = [CameraAction.Pan, CameraAction.Tilt, CameraAction.Roll]\n    this.eyes.position.set(0, 0, 0)\n    this.eyes.rotation.set(0, 0, 0)\n    this.head.position.set(0, 0, 0)\n    this.head.rotation.set(0, 0, 0)\n    this.body.position.copy(position)\n    actions.forEach((action) => {\n      const axis = this.getAxisFor(action)\n      if (this.translateAlong[action]) {\n        this.body.rotation[axis] = currentRotation[axis]\n      } else {\n        this.eyes.rotation[axis] = currentRotation[axis]\n      }\n    })\n    this.camera.rotation.set(0, 0, 0)\n    this.camera.position.set(0, 0, 0)\n  }\n\n  /**\n   * Packs transfrom into the body and head, and 0s out transforms of the eyes. Useful for preparing the\n   * rig for control through an animation clip.\n   */\n  packTransform(): void {\n    const { position, quaternion } = this.getWorldCoordinates()\n    this.body.position.copy(position)\n    this.body.rotation.set(0, 0, 0)\n    this.head.quaternion.copy(quaternion)\n    this.head.position.set(0, 0, 0)\n    this.eyes.position.set(0, 0, 0)\n    this.eyes.rotation.set(0, 0, 0)\n  }\n\n  /**\n   * Unpacks the current camera world coordinates and distributes transforms\n   * across the rig componenets.\n   */\n  unpackTransform(): void {\n    const { position, quaternion } = this.getWorldCoordinates()\n    this.setWorldCoordinates({ position, quaternion })\n  }\n\n  /**\n   * Disassemble the camera from the rig and attach it to the scene.\n   */\n  disassemble(): void {\n    if (this.cameraIsInRig) {\n      this.scene.attach(this.camera)\n      this.cameraIsInRig = false\n    }\n  }\n\n  /**\n   * Place the camera back in the rig\n   */\n  assemble(): void {\n    if (!this.cameraIsInRig) {\n      this.eyes.attach(this.camera)\n      this.unpackTransform()\n      this.cameraIsInRig = true\n    }\n  }\n\n  /**\n   * Get the rotation order as a string compatible with what three.js uses\n   */\n  getRotationOrder(): string {\n    return Object.values(this.actionAxes).join('').toUpperCase()\n  }\n\n  /**\n   * Whether the camera is currently attached to the rig\n   */\n  isInRig(): boolean {\n    return this.cameraIsInRig\n  }\n\n  /**\n   * If the camera is in the middle of a transition\n   */\n  isMoving(): boolean {\n    return this.inTransit\n  }\n\n  /**\n   * Set the up axis for the camera\n   * @param axis - New Up axis\n   */\n  setUpAxis(axis: Axis): void {\n    this.upAxis = axis\n    this.actionAxes = ActionMappingByUpAxis[this.upAxis]\n    this.body.rotation.order = this.getRotationOrder()\n  }\n\n  /**\n   * Set an animation clip for the rig\n   * @param {AnimationClip} clip - AnimationClip containing a VectorKeyFrameTrack for position and a QuaternionKeyFrameTrack for rotation\n   * @param {string} translationObjectName - Name of translation object\n   * @param {string} rotationObjectName -  Name of rotation object\n   */\n  setAnimationClip(clip: AnimationClip, translationObjectName?: string, rotationObjectName?: string): void {\n    this.animationClip = clip\n    if (translationObjectName) this.animationTranslationObjectName = translationObjectName\n    if (rotationObjectName) this.animationRotationObjectName = rotationObjectName\n    this.hasAnimation = true\n    // hack. threejs skips last frame when seek time = clip duration\n    this.animationClip.duration += 0.01\n    this.mixer = new AnimationMixer(this.body)\n    const action = this.mixer.clipAction(this.animationClip)\n    action.clampWhenFinished = true\n    action.play()\n  }\n\n  /**\n   * Transition to a specific position and orientation in world space.\n   * Transform on eyes will be reset to 0 as a result of this.\n   * @param position\n   * @param quaternion\n   * @param duration\n   * @param ease\n   * @param useSlerp\n   */\n  flyTo(position: Vector3, quaternion: Quaternion, duration = 1, ease = 'power1', useSlerp = true): void {\n    if (!this.isMoving()) {\n      const currentCoords = this.getWorldCoordinates()\n      const currentValues = {\n        px: currentCoords.position.x,\n        py: currentCoords.position.y,\n        pz: currentCoords.position.z,\n        qx: currentCoords.quaternion.x,\n        qy: currentCoords.quaternion.y,\n        qz: currentCoords.quaternion.z,\n        qw: currentCoords.quaternion.w,\n        slerpAmt: 0,\n      }\n      const targetValues = {\n        px: position.x,\n        py: position.y,\n        pz: position.z,\n        qx: quaternion.x,\n        qy: quaternion.y,\n        qz: quaternion.z,\n        qw: quaternion.w,\n        slerpAmt: 1,\n      }\n      const tempQuaternion = new Quaternion()\n      const startQuaternion = new Quaternion(currentValues.qx, currentValues.qy, currentValues.qz, currentValues.qw)\n      const onStart = (): void => {\n        this.inTransit = true\n        this.packTransform()\n        this.dispatchEvent({ type: 'CameraMoveStart' } as CameraMoveStartEvent)\n      }\n      const onUpdate = (tween): void => {\n        this.body.position.set(currentValues.px, currentValues.py, currentValues.pz)\n        if (useSlerp) {\n          tempQuaternion.slerpQuaternions(startQuaternion, quaternion, currentValues.slerpAmt)\n          this.head.setRotationFromQuaternion(tempQuaternion)\n        } else {\n          this.head.quaternion.set(currentValues.qx, currentValues.qy, currentValues.qz, currentValues.qw)\n        }\n        this.dispatchEvent({\n          type: 'CameraMoveUpdate',\n          progress: tween.progress(),\n        } as CameraMoveUpdateEvent)\n      }\n      const onComplete = (): void => {\n        this.inTransit = false\n        this.unpackTransform()\n        this.dispatchEvent({ type: 'CameraMoveEnd' } as CameraMoveEndEvent)\n      }\n      gsap.to(currentValues, {\n        duration,\n        ease,\n        ...targetValues,\n        onStart,\n        onUpdate: function () {\n          onUpdate(this)\n        },\n        onComplete,\n      })\n    }\n  }\n\n  /**\n   * Transition to a specific keyframe on the animation clip\n   * Transform on eyes will be reset to 0 as a result of this.\n   * @param frame - frame\n   * @param duration - duration\n   * @param ease - ease\n   */\n  flyToKeyframe(frame: number, duration = 1, ease = 'power1'): void {\n    if (this.hasAnimation && !this.isMoving()) {\n      const currentValues = {\n        time: this.mixer.time,\n      }\n      const targetValues = {\n        time: this.animationClip.tracks[0].times[frame],\n      }\n      const onStart = (): void => {\n        this.inTransit = true\n        this.dispatchEvent({ type: 'CameraMoveStart' } as CameraMoveStartEvent)\n      }\n      const onUpdate = (tween): void => {\n        this.mixer.setTime(currentValues.time)\n        this.dispatchEvent({\n          type: 'CameraMoveUpdate',\n          progress: tween.progress(),\n        } as CameraMoveUpdateEvent)\n      }\n      const onComplete = (): void => {\n        this.inTransit = false\n        this.dispatchEvent({ type: 'CameraMoveEnd' } as CameraMoveEndEvent)\n      }\n      gsap.to(currentValues, {\n        duration,\n        ease,\n        ...targetValues,\n        onStart,\n        onUpdate: function () {\n          onUpdate(this)\n        },\n        onComplete,\n      })\n    }\n  }\n\n  /**\n   * @param percentage - percentage of animation clip to move to, between 0 and 1\n   */\n  setAnimationPercentage(percentage: number): void {\n    if (this.hasAnimation) {\n      const percent = Math.max(\n        0,\n        Math.min(percentage * this.animationClip.duration, this.animationClip.duration - 0.0001),\n      )\n      this.mixer.setTime(percent)\n    }\n  }\n\n  /**\n   * @param time - timestamp of animation clip to move to\n   */\n  setAnimationTime(time: number): void {\n    if (this.hasAnimation) this.mixer.setTime(time)\n  }\n\n  /**\n   * @param frame - frame of animation clip to move to\n   */\n  setAnimationKeyframe(frame: number): void {\n    if (this.hasAnimation) this.mixer.setTime(this.animationClip.tracks[0].times[frame])\n  }\n}\n","import { EventDispatcher } from 'three'\n\nexport abstract class BaseAdaptor extends EventDispatcher {\n  constructor() {\n    super()\n  }\n  abstract connect(): void\n  abstract disconnect(): void\n  abstract update(time?: number): void\n  abstract isEnabled(): boolean\n}\n\nexport interface DiscreteEvent {\n  type: 'trigger'\n}\n\nexport interface ContinuousEvent {\n  type: 'update'\n}\n\nexport interface IntertiaCompleteEvent {\n  type: 'inertiacomplete'\n}\n","import { BaseAdaptor, DiscreteEvent, ContinuousEvent, IntertiaCompleteEvent } from './BaseAdaptor'\nimport { Damper, DamperValues } from '../Damper'\n\n/**\n * Event: Fired when a key in a `discrete` KeyboardAdaptor's mapping is released (`onKeyUp`)\n * @example\n * ```javascript\n * adaptor.on('trigger', () => { // do something })\n * ```\n * */\nexport interface KeyboardAdaptorDiscreteEvent extends DiscreteEvent {\n  /** KeyMapping key that triggered the event */\n  trigger: string\n}\n\n/**\n * Event: Fired when a key in a `continuous` KeyboardAdaptor's mapping is pressed (`onKeyDown`)\n * @example\n * ```javascript\n * adaptor.on('update', () => { // do something })\n * ```\n * */\nexport interface KeyboardAdaptorContinuousEvent extends ContinuousEvent {\n  values: DamperValues\n  deltas: DamperValues\n}\n\n/**\n * A discrete adaptor works as a trigger - only firing events on keyup,\n * whereas a continuous adaptor continuously fires events on keydown\n * */\nexport type KeyboardAdaptorType = 'discrete' | 'continuous'\n\n/**\n * Key-value pairs of semantic labels associated with an array of keys (corresponding to `KeybordEvent.keys` values)\n */\nexport interface KeyMapping {\n  /** The key is a semantic label, and the string[] is a corresponding collection of event.keys */\n  [key: string]: string[]\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#KeyboardAdaptor} constructor\n */\nexport interface KeyboardAdaptorProps {\n  /** 'discrete' or 'continuous' */\n  type: KeyboardAdaptorType\n  /**\n   * Default key mapping uses forward/backward/up/down/left/right as semanic labels, with WASD and arrow keys mapped appropriately:\n   * @example keyMapping\n   * ```javascript\n   * {\n   *   forward: ['ArrowUp', 'w', 'W'],\n   *   backward: ['ArrowDown', 's', 'S'],\n   *   left: ['ArrowLeft', 'a', 'A'],\n   *   right: ['ArrowRight', 'd', 'D'],\n   *   up: ['u', 'U'],\n   *   down: ['n', 'N'],\n   * }\n   * ```\n   * */\n  keyMapping?: KeyMapping\n  /** Only used for continuous adaptor, value between 0 and 1. Defaults to 0.5 */\n  dampingFactor?: number\n  /** Only used for continuous adaptor, the amount to increment the target value on each keydown event. Defaults to 1 */\n  incrementor?: number\n  /** Prevent event bubbling. Defaults to true */\n  preventBubbling?: boolean\n}\n\nconst defaultProps: Partial<KeyboardAdaptorProps> = {\n  keyMapping: {\n    forward: ['ArrowUp', 'w', 'W'],\n    backward: ['ArrowDown', 's', 'S'],\n    left: ['ArrowLeft', 'a', 'A'],\n    right: ['ArrowRight', 'd', 'D'],\n    up: ['u', 'U'],\n    down: ['n', 'N'],\n  },\n  dampingFactor: 0.5,\n  incrementor: 1,\n  preventBubbling: true,\n}\n\n/**\n * Parse keyboard events and emit either dampened values for continuous keypresses, or trigger events named according to a provided keymapping.\n * @remarks\n * See {@link three-story-controls#KeyboardAdaptorProps} for all properties that can be passed to the constructor.\n * See {@link three-story-controls#KeyboardAdaptorDiscreteEvent} and {@link three-story-controls#KeyboardAdaptorContinuousEvent} for emitted event signatures.\n * @example Continuous adaptor\n * ```javascript\n * const keyboardAdaptor = new KeyboardAdaptor({ type: 'continuous', dampingFactor: 0.2 })\n * keyboardAdaptor.connect()\n * keyboardAdaptor.addEventListener('update', (event) => {\n *   cube.rotation.y += event.deltas.right - event.deltas.left\n *   cube.rotation.x += event.deltas.up - event.deltas.down\n * )}\n * function animate() {\n *  keyboardAdaptor.update()\n *  window.requestAnimationFrame(animate)\n * }\n * animate()\n * ```\n */\nexport class KeyboardAdaptor extends BaseAdaptor {\n  private type: KeyboardAdaptorType\n  private damper: Damper\n  private dampingFactor: number\n  private incrementor: number\n  private keyMapping: KeyMapping\n  private connected: boolean\n  private preventBubbling: boolean\n\n  constructor(props: KeyboardAdaptorProps) {\n    super()\n    Object.assign(this, defaultProps, props)\n    const values = {}\n    for (const key in this.keyMapping) {\n      values[key] = 0\n    }\n    this.damper = new Damper({\n      values,\n      dampingFactor: this.dampingFactor,\n    })\n    this.onKeyUp = this.onKeyUp.bind(this)\n    this.onKeyDown = this.onKeyDown.bind(this)\n  }\n\n  connect(): void {\n    document.addEventListener('keyup', this.onKeyUp, true)\n    document.addEventListener('keydown', this.onKeyDown, true)\n    this.connected = true\n  }\n\n  disconnect(): void {\n    document.removeEventListener('keyup', this.onKeyUp, true)\n    document.removeEventListener('keydown', this.onKeyDown, true)\n    this.connected = false\n  }\n\n  update(): void {\n    if (this.type === 'continuous' && !this.damper.reachedTarget()) {\n      this.damper.update()\n      this.dispatchEvent({\n        type: 'update',\n        values: this.damper.getCurrentValues(),\n        deltas: this.damper.getDeltaValues(),\n      } as KeyboardAdaptorContinuousEvent)\n      if (this.damper.reachedTarget()) {\n        this.damper.resetAll(0)\n        this.dispatchEvent({\n          type: 'inertiacomplete',\n        } as IntertiaCompleteEvent)\n      }\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.connected\n  }\n\n  private onKeyUp(event: KeyboardEvent): void {\n    if (this.type === 'discrete') {\n      for (const name in this.keyMapping) {\n        if (this.keyMapping[name].includes(event.key)) {\n          if (this.preventBubbling) event.preventDefault()\n          this.dispatchEvent({\n            type: 'trigger',\n            trigger: name,\n          } as KeyboardAdaptorDiscreteEvent)\n          break\n        }\n      }\n    }\n  }\n\n  private onKeyDown(event: KeyboardEvent): void {\n    if (this.type === 'continuous') {\n      for (const name in this.keyMapping) {\n        if (this.keyMapping[name].includes(event.key)) {\n          if (this.preventBubbling) event.preventDefault()\n          this.damper.addToTarget(name, this.incrementor)\n          break\n        }\n      }\n    }\n  }\n}\n","import { BaseAdaptor, ContinuousEvent, IntertiaCompleteEvent } from './BaseAdaptor'\nimport { Damper, DamperValues } from '../Damper'\n\ninterface Coordinates extends DamperValues {\n  x: number\n  y: number\n}\n\n/**\n * Event: Fired when when `PointerEvent`s are triggered\n * @example\n * ```javascript\n * adaptor.on('trigger', (e) => {\n *   console.log('x/y coordinates', e.values.x, e.values.y)\n * })\n * ```\n * */\nexport interface PointerAdaptorEvent extends ContinuousEvent {\n  /** Dampened x and y pointer coordinates */\n  values: Coordinates\n  /** Pointer coordinate change since previous update */\n  deltas: Coordinates\n  /** Number of pointers registered */\n  pointerCount: number\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#PointerAdaptor} constructor\n */\nexport interface PointerAdaptorProps {\n  /** DOM element that should listen for pointer events. Defaults to `document.body` */\n  domElement?: HTMLElement\n  /** Damping value between 0 and 1. Defaults to 0.5 */\n  dampingFactor?: number\n  /** Whether to normalize the pointer position values. Defaults to true */\n  shouldNormalize?: boolean\n  /** If values are normalized, whether they should be in -1 to 1 range. Defaults to true. */\n  normalizeAroundZero?: boolean\n  /** Debounce for registering a change in the pointer count, in ms. Defaults to 100. */\n  multipointerThreshold?: number\n}\n\nconst defaultProps: PointerAdaptorProps = {\n  domElement: document.body,\n  dampingFactor: 0.5,\n  shouldNormalize: true,\n  normalizeAroundZero: true,\n  multipointerThreshold: 100,\n}\n\n/**\n * Parse pointer events to emit dampened, normalized coordinates along with the pointer count (for detecting multi-touch or drag events)\n * @remarks\n * See {@link three-story-controls#PointerAdaptorProps} for all properties that can be passed to the constructor.\n * See {@link three-story-controls#PointerAdaptorEvent} for emitted event signatures.\n * Note: CSS property `touch-action: none` will probably be needed on listener element.\n * @example Pointer adaptor\n * ```javascript\n * const pointerAdaptor = new PointerAdaptor()\n * pointerAdaptor.connect()\n * pointerAdaptor.addEventListener('update', (event) => {\n *  switch(event.pointerCount) {\n *    case 0:\n *      cube.scale.x = event.values.x\n *      cube.scale.y = event.values.y\n *      break\n *    case 1:\n *      cube.position.x += event.deltas.x\n *      cube.position.y -= event.deltas.y\n *      break\n *    default:\n *      break\n *  }\n * })\n *\n * // in RAF loop:\n * function animate(t) {\n *  pointerAdaptor.update(t)\n * }\n * ```\n */\nexport class PointerAdaptor extends BaseAdaptor {\n  private domElement = document.body\n  private dampingFactor: number\n  private shouldNormalize = true\n  private normalizeAroundZero = true\n  private multipointerThreshold: number\n  private damper: Damper\n  private connected: boolean\n  private width: number\n  private height: number\n  private pointerCount = 0\n  private recordedPosition = false\n  private cache: Array<PointerEvent> = []\n  private lastDownTime = 0\n  private lastUpTime = 0\n\n  constructor(props: PointerAdaptorProps) {\n    super()\n    Object.assign(this, defaultProps, props)\n    this.damper = new Damper({\n      values: { x: null, y: null },\n      dampingFactor: this.dampingFactor,\n    })\n    this.setDimensions()\n    this.onPointerMove = this.onPointerMove.bind(this)\n    this.onPointerUp = this.onPointerUp.bind(this)\n    this.onPointerDown = this.onPointerDown.bind(this)\n    this.onResize = this.onResize.bind(this)\n  }\n\n  connect(): void {\n    this.domElement.addEventListener('pointermove', this.onPointerMove, { passive: true })\n    this.domElement.addEventListener('pointerdown', this.onPointerDown, { passive: true })\n    this.domElement.addEventListener('pointerleave', this.onPointerUp, { passive: true })\n    this.domElement.addEventListener('pointerup', this.onPointerUp, { passive: true })\n    window.addEventListener('resize', this.onResize)\n    this.connected = true\n  }\n\n  disconnect(): void {\n    this.domElement.removeEventListener('pointermove', this.onPointerMove)\n    this.domElement.removeEventListener('pointerdown', this.onPointerDown)\n    this.domElement.removeEventListener('pointerleave', this.onPointerUp)\n    this.domElement.removeEventListener('pointerup', this.onPointerUp)\n    this.connected = false\n  }\n\n  update(time: number): void {\n    if (\n      this.pointerCount !== this.cache.length &&\n      time - this.lastDownTime > this.multipointerThreshold &&\n      time - this.lastUpTime > this.multipointerThreshold\n    ) {\n      this.pointerCount = this.cache.length\n      if (this.pointerCount === 0) {\n        this.damper.resetAll(null)\n        this.recordedPosition = false\n      } else {\n        this.damper.resetData(this.getPointerPosition(this.cache[0]))\n        this.recordedPosition = true\n      }\n    }\n\n    if (!this.damper.reachedTarget()) {\n      this.damper.update()\n      this.dispatchEvent({\n        type: 'update',\n        values: this.shouldNormalize\n          ? this.normalize(this.damper.getCurrentValues() as Coordinates, this.normalizeAroundZero)\n          : this.damper.getCurrentValues(),\n        deltas: this.shouldNormalize\n          ? this.normalize(this.damper.getDeltaValues() as Coordinates, false)\n          : this.damper.getDeltaValues(),\n        pointerCount: this.pointerCount,\n      } as PointerAdaptorEvent)\n      if (this.damper.reachedTarget()) {\n        this.dispatchEvent({ type: 'inertiacomplete' } as IntertiaCompleteEvent)\n      }\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.connected\n  }\n\n  private setDimensions(): void {\n    this.width = this.domElement.getBoundingClientRect().width\n    this.height = this.domElement.getBoundingClientRect().height\n  }\n\n  private getPointerPosition(event: PointerEvent): Coordinates {\n    // event.offsetLeft is still experimental\n    return {\n      x: Math.max(0, Math.min(this.width, event.x - this.domElement.offsetLeft)),\n      y: Math.max(0, Math.min(this.height, event.y - this.domElement.offsetTop)),\n    }\n  }\n\n  private normalize(values: Coordinates, aroundZero: boolean): Coordinates {\n    let x = values.x / this.width\n    let y = values.y / this.height\n    if (aroundZero) {\n      x = x * 2 - 1\n      y = y * 2 - 1\n    }\n    return { x, y }\n  }\n\n  private onPointerMove(event: PointerEvent): void {\n    if (this.pointerCount === this.cache.length) {\n      if (this.cache.length === 0) {\n        if (!this.recordedPosition) {\n          this.damper.resetData(this.getPointerPosition(event))\n          this.recordedPosition = true\n        } else {\n          this.damper.setTarget(this.getPointerPosition(event))\n        }\n      } else {\n        if (event.pointerId === this.cache[0].pointerId) {\n          this.damper.setTarget(this.getPointerPosition(event))\n        }\n      }\n    }\n  }\n\n  private onPointerDown(event: PointerEvent): void {\n    // only deals with left mouse button right now\n    // TODO: add some logic for optional right button events\n    if (event.button === 0) {\n      this.cache.push(event)\n      this.lastDownTime = window.performance.now()\n    }\n  }\n\n  private onPointerUp(event: PointerEvent): void {\n    if (event.button === 0 || event.type === 'pointerleave') {\n      for (let i = 0; i < this.cache.length; i++) {\n        if (this.cache[i].pointerId == event.pointerId) {\n          this.cache.splice(i, 1)\n          break\n        }\n      }\n      this.lastUpTime = window.performance.now()\n    }\n  }\n\n  private onResize(): void {\n    this.setDimensions()\n  }\n}\n","import { BaseAdaptor, ContinuousEvent, IntertiaCompleteEvent } from './BaseAdaptor'\nimport { Damper, DamperValues } from '../Damper'\n\n/**\n * Event: Fired when when the 'in view' amount of the given DOM element changes\n */\nexport interface ScrollAdaptorEvent extends ContinuousEvent {\n  values: DamperValues\n  dampenedValues: DamperValues\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#ScrollAdaptor} constructor\n */\nexport interface ScrollAdaptorProps {\n  /** Long DOM Element to observe */\n  scrollElement: HTMLElement\n  /** Offset to start registering scroll, in px or vh. Default starts when top of element is at bottom of viewport. */\n  startOffset?: string\n  /** Offset to end registering scroll, in px or vh. Default ends when bottom of element is at top of viewport. */\n  endOffset?: string\n  /** Buffer before and after element to start registering scroll. Number between 0 and 1, defaults to 0.1 */\n  buffer?: number\n  /** Value between 0 and 1. Defaults to 0.5 */\n  dampingFactor?: number\n}\n\nconst defaultProps: Partial<ScrollAdaptorProps> = {\n  startOffset: '0px',\n  endOffset: '0px',\n  buffer: 0.1,\n  dampingFactor: 0.5,\n}\n\n/**\n * Emits normalized values for the amount a given DOM element has been scrolled through.\n * @remarks\n * See {@link three-story-controls#ScrollAdaptorProps} for all properties that can be passed to the constructor.\n * See {@link three-story-controls#ScrollAdaptorEvent} for emitted event signatures.\n * @example Scroll adaptor\n * ```javascript\n * const scrollAdaptor = new ScrollAdaptor({ scrollElement: document.querySelector('.scroller'), dampingFactor: 0.1 })\n * scrollAdaptor.connect()\n * scrollAdaptor.addEventListener('update', (event) => {\n *   cube.rotation.y = event.dampenedValues.scrollPercent*Math.PI*2\n * })\n * ```\n */\nexport class ScrollAdaptor extends BaseAdaptor {\n  private scrollElement: HTMLElement\n  private damper: Damper\n  private dampingFactor: number\n  private connected: boolean\n  private values: DamperValues\n  private lastSeenScrollValue: number\n  private previousScrollValue: number\n  private startPosition: number\n  private endPosition: number\n  private distance: number\n  private bufferedStartPosition: number\n  private bufferedEndPosition: number\n  private startOffset: string\n  private endOffset: string\n  private buffer: number\n  private resizeObserver: ResizeObserver\n\n  constructor(props: ScrollAdaptorProps) {\n    super()\n    Object.assign(this, defaultProps, props)\n    this.lastSeenScrollValue = window.scrollY || -1\n    this.previousScrollValue = this.lastSeenScrollValue\n    this.values = {\n      scrollPx: null,\n      scrollPercent: null,\n    }\n    this.damper = new Damper({\n      values: this.values,\n      dampingFactor: this.dampingFactor,\n    })\n    this.calculateDimensions = this.calculateDimensions.bind(this)\n    this.onScroll = this.onScroll.bind(this)\n    this.resizeObserver = new ResizeObserver(this.calculateDimensions)\n    this.calculateDimensions()\n  }\n\n  connect(): void {\n    window.addEventListener('scroll', this.onScroll, { passive: true })\n    this.resizeObserver.observe(document.body)\n    this.connected = true\n  }\n\n  disconnect(): void {\n    window.removeEventListener('scroll', this.onScroll)\n    this.resizeObserver.unobserve(document.body)\n    this.connected = false\n  }\n\n  update(): void {\n    if (\n      this.lastSeenScrollValue !== this.previousScrollValue &&\n      this.lastSeenScrollValue >= this.bufferedStartPosition &&\n      this.lastSeenScrollValue <= this.bufferedEndPosition\n    ) {\n      const scrollPx = Math.max(0, Math.min(this.distance, this.lastSeenScrollValue - this.startPosition))\n      const scrollPercent = Math.max(0, Math.min(1, scrollPx / this.distance))\n      this.values = {\n        scrollPx,\n        scrollPercent,\n      }\n      this.damper.setTarget(this.values)\n      this.previousScrollValue = this.lastSeenScrollValue\n    }\n    if (!this.damper.reachedTarget()) {\n      this.damper.update()\n      this.dispatchEvent({\n        type: 'update',\n        values: this.values,\n        dampenedValues: this.damper.getCurrentValues(),\n      } as ScrollAdaptorEvent)\n      if (this.damper.reachedTarget()) {\n        this.dispatchEvent({ type: 'inertiacomplete' } as IntertiaCompleteEvent)\n      }\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.connected\n  }\n\n  parseOffset(offset: string): number {\n    let amount = 0\n    if (offset) {\n      amount = parseInt(offset)\n      if (offset.indexOf('vh') !== -1) {\n        amount = (amount * window.innerHeight) / 100\n      } else if (this.distance && offset.indexOf('%') !== -1) {\n        amount = (amount * this.distance) / 100\n      }\n    }\n    return amount\n  }\n\n  private calculateOffset(element: HTMLElement): number {\n    if (!element) return 0\n    return this.calculateOffset(element.offsetParent as HTMLElement) + element.offsetTop\n  }\n\n  private calculateDimensions(): void {\n    const elementHeight = this.scrollElement.clientHeight\n    const offsetTop = this.calculateOffset(this.scrollElement)\n    this.startPosition = offsetTop - window.innerHeight + this.parseOffset(this.startOffset)\n    this.endPosition = offsetTop + elementHeight + this.parseOffset(this.endOffset)\n    this.distance = this.endPosition - this.startPosition\n    this.bufferedStartPosition = Math.max(0, this.startPosition * (1 - this.buffer))\n    this.bufferedEndPosition = Math.min(\n      this.endPosition * (1 + this.buffer),\n      document.body.getBoundingClientRect().height,\n    )\n  }\n\n  private onScroll(): void {\n    this.lastSeenScrollValue = window.scrollY\n  }\n}\n","import { BaseAdaptor, DiscreteEvent } from './BaseAdaptor'\n\n/**\n * Event: Fired when when swipe are registered\n * @remarks\n * The sign represents the direction of the swipe,\n * y = 1 when swiping down-to-up, and x = 1 when swiping left-to-right\n * */\nexport interface SwipeAdaptorEvent extends DiscreteEvent {\n  x: -1 | 1 | 0\n  y: -1 | 1 | 0\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#SwipeAdaptor} constructor\n */\nexport interface SwipeAdaptorProps {\n  /** DOM element to listen to events on. Defaults to document.body */\n  domElement?: HTMLElement\n  /** Threshold of pointer's deltaX to trigger events. Defaults to 60 */\n  thresholdX?: number\n  /** Threshold of pointer's deltaY to trigger events. Defaults to 60 */\n  thresholdY?: number\n}\n\nconst defaultProps: SwipeAdaptorProps = {\n  domElement: document.body,\n  thresholdX: 60,\n  thresholdY: 60,\n}\n\n/**\n * Emits events in response to swipe gestures above a given threshold.\n * @remarks\n * See {@link three-story-controls#SwipeAdaptorProps} for all properties that can be passed to the constructor.\n * See {@link three-story-controls#SwipeAdaptorEvent} for emitted event signatures.\n * Note: CSS property `touch-action: none` will probably be needed on listener element\n * @example Swipe adaptor\n * ```javascript\n * const swipeAdaptor = new SwipeAdaptor()\n * swipeAdaptor.connect()\n * swipeAdaptor.addEventListener('trigger', (event) => {\n *   cube.scale.y += event.y*0.1\n * })\n * ```\n */\nexport class SwipeAdaptor extends BaseAdaptor {\n  private domElement: HTMLElement\n  private thresholdX: number\n  private thresholdY: number\n  private startX: number\n  private startY: number\n  private connected: boolean\n\n  constructor(props: SwipeAdaptorProps = {}) {\n    super()\n    Object.assign(this, defaultProps, props)\n    this.onPointerUp = this.onPointerUp.bind(this)\n    this.onPointerDown = this.onPointerDown.bind(this)\n  }\n\n  connect(): void {\n    this.domElement.addEventListener('pointerdown', this.onPointerDown, { passive: true })\n    this.domElement.addEventListener('pointerup', this.onPointerUp, { passive: true })\n    this.connected = true\n  }\n\n  disconnect(): void {\n    this.domElement.removeEventListener('pointerdown', this.onPointerDown)\n    this.domElement.removeEventListener('pointerup', this.onPointerUp)\n    this.connected = false\n  }\n\n  update(): void {\n    // nothing to do here\n  }\n\n  isEnabled(): boolean {\n    return this.connected\n  }\n\n  private onPointerDown(event: PointerEvent): void {\n    if (event.pointerType !== 'mouse' && event.isPrimary) {\n      this.startX = event.screenX\n      this.startY = event.screenY\n    }\n  }\n\n  private onPointerUp(event: PointerEvent): void {\n    if (event.pointerType !== 'mouse' && event.isPrimary) {\n      const diffX = event.screenX - this.startX\n      const diffY = event.screenY - this.startY\n      if (Math.abs(diffX) >= this.thresholdX || Math.abs(diffY) >= this.thresholdY) {\n        this.dispatchEvent({\n          type: 'trigger',\n          x: Math.abs(diffX) >= this.thresholdX ? Math.sign(diffX) : 0,\n          y: Math.abs(diffY) >= this.thresholdY ? Math.sign(-1 * diffY) : 0,\n        } as SwipeAdaptorEvent)\n      }\n    }\n  }\n}\n","import { BaseAdaptor, DiscreteEvent, ContinuousEvent, IntertiaCompleteEvent } from './BaseAdaptor'\nimport { Damper, DamperValues } from '../Damper'\n\n/**\n * Event: Fired when when discrete `wheel` events are registered\n * @remarks\n * The sign represents the the direction of the wheel event that caused the event to trigger\n * */\nexport interface WheelAdaptorDiscreteEvent extends DiscreteEvent {\n  x: -1 | 1 | 0\n  y: -1 | 1 | 0\n}\n\n/**\n * Event: Fired on a continuous `WheelAdaptor` in response to `wheel` events\n * @remarks\n * DamperValues have `x` and `y` keys.\n * */\nexport interface WheelAdaptorContinuousEvent extends ContinuousEvent {\n  values: DamperValues\n  deltas: DamperValues\n}\n\n/**\n * A discrete adaptor works as a trigger - only firing events when wheel events pass a given threshold,\n * whereas a continuous adaptor continuously fires events on wheel\n * */\nexport type WheelAdaptorType = 'discrete' | 'continuous'\n\n/**\n * Properties that can be passed to the {@link three-story-controls#WheelAdaptor} constructor\n */\nexport interface WheelAdaptorProps {\n  /** 'discrete' or 'continuous' */\n  type: WheelAdaptorType\n  /** DOM element to listen to events on. Defaults to window */\n  domElement?: HTMLElement\n  /** Only used for continuous adaptor, value between 0 and 1. Defaults to 0.5 */\n  dampingFactor?: number\n  /** Only used for discrete adaptor, threshold of wheel.deltaX to trigger events. Defaults to 15 */\n  thresholdX?: number\n  /** Only used for discrete adaptor, threshold of wheel.deltaY to trigger events. Defaults to 15 */\n  thresholdY?: number\n  /** Only used for discrete adaptor, rest duration between firing trigger events. Defaults to 700 */\n  debounceDuration?: number\n}\n\nconst defaultProps: Partial<WheelAdaptorProps> = {\n  dampingFactor: 0.5,\n  thresholdX: 15,\n  thresholdY: 15,\n  debounceDuration: 700,\n}\n\n/**\n * Parse mouse wheel events and emit either dampened values, or trigger events for swipes that cross a given threshold.\n * @remarks\n * See {@link three-story-controls#WheelAdaptorProps} for all properties that can be passed to the constructor.\n * See {@link three-story-controls#WheelAdaptorDiscreteEvent} and {@link three-story-controls#WheelAdaptorContinuousEvent} for emitted event signatures.\n * @example Discrete adaptor\n * ```javascript\n * const wheelAdaptor = new WheelAdaptor({ type: 'discrete' })\n * wheelAdaptor.connect()\n * wheelAdaptor.addEventListener('trigger', (event) => {\n *   cube.scale.y += event.y*0.1\n * })\n * ```\n */\nexport class WheelAdaptor extends BaseAdaptor {\n  private type: WheelAdaptorType\n  private domElement: HTMLElement\n  private dampingFactor: number\n  private damper: Damper\n  private thresholdX: number\n  private thresholdY: number\n  private debounceDuration: number\n  private lastThresholdTrigger = 0\n  private connected: boolean\n\n  constructor(props: WheelAdaptorProps) {\n    super()\n    Object.assign(this, defaultProps, props)\n    this.damper = new Damper({\n      values: { x: 0, y: 0 },\n      dampingFactor: this.dampingFactor,\n    })\n    this.onWheel = this.onWheel.bind(this)\n  }\n\n  connect(): void {\n    const element = this.domElement || window\n    element.addEventListener('wheel', this.onWheel, { passive: true })\n    this.connected = true\n  }\n\n  disconnect(): void {\n    const element = this.domElement || window\n    element.removeEventListener('wheel', this.onWheel)\n    this.connected = false\n  }\n\n  update(): void {\n    if (this.type === 'continuous' && !this.damper.reachedTarget()) {\n      this.damper.update()\n      this.dispatchEvent({\n        type: 'update',\n        values: this.damper.getCurrentValues(),\n        deltas: this.damper.getDeltaValues(),\n      } as WheelAdaptorContinuousEvent)\n      if (this.damper.reachedTarget()) {\n        this.damper.resetAll(0)\n        this.dispatchEvent({\n          type: 'inertiacomplete',\n        } as IntertiaCompleteEvent)\n      }\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.connected\n  }\n\n  private onWheel(event: WheelEvent): void {\n    if (this.type === 'continuous') {\n      this.damper.addToTarget('x', event.deltaX)\n      this.damper.addToTarget('y', event.deltaY)\n    } else if (this.type === 'discrete') {\n      if (Math.abs(event.deltaX) >= this.thresholdX || Math.abs(event.deltaY) >= this.thresholdY) {\n        const now = window.performance.now()\n        if (now - this.lastThresholdTrigger > this.debounceDuration) {\n          this.lastThresholdTrigger = now\n          this.dispatchEvent({\n            type: 'trigger',\n            x: Math.abs(event.deltaX) >= this.thresholdX ? Math.sign(event.deltaX) : 0,\n            y: Math.abs(event.deltaY) >= this.thresholdY ? Math.sign(event.deltaY) : 0,\n          } as WheelAdaptorDiscreteEvent)\n        }\n      }\n    }\n  }\n}\n","import { BaseControls } from './BaseControls'\nimport { CameraRig, CameraAction } from '../CameraRig'\nimport { KeyboardAdaptor } from '../adaptors/KeyboardAdaptor'\nimport { PointerAdaptor } from '../adaptors/PointerAdaptor'\nimport { WheelAdaptor } from '../adaptors/WheelAdaptor'\n\n/**\n * Properties that can be passed to the {@link three-story-controls#FreeMovementControls} constructor\n */\nexport interface FreeMovementControlsProps {\n  domElement?: HTMLElement\n  /** Damping factor between 0 and 1. Defaults to 0.3 */\n  pointerDampFactor?: number\n  /** Mutiplier for two-pointer translation. Defaults to 4 */\n  pointerScaleFactor?: number\n  /** Damping factor between 0 and 1. Defaults to 0.5 */\n  keyboardDampFactor?: number\n  /** Mutiplier for keyboard translation. Defaults to 0.5 */\n  keyboardScaleFactor?: number\n  /** Damping factor between 0 and 1. Defaults to 0.25 */\n  wheelDampFactor?: number\n  /** Mutiplier for wheel translation. Defaults to 0.05 */\n  wheelScaleFactor?: number\n  /** Mutiplier for panning. Defaults to Math.PI / 4 */\n  panDegreeFactor?: number\n  /** Mutiplier for tilting. Defaults to Math.PI / 10 */\n  tiltDegreeFactor?: number\n}\n\nconst defaultProps: FreeMovementControlsProps = {\n  domElement: document.body,\n  pointerDampFactor: 0.3,\n  pointerScaleFactor: 4,\n  keyboardDampFactor: 0.5,\n  keyboardScaleFactor: 0.5,\n  wheelDampFactor: 0.25,\n  wheelScaleFactor: 0.05,\n  panDegreeFactor: Math.PI / 4,\n  tiltDegreeFactor: Math.PI / 10,\n}\n\n/**\n * Control scheme to move the camera with arrow/WASD keys and mouse wheel; and rotate the camera with click-and-drag events.\n * @remarks\n * Control scheme to move the camera with arrow/WASD keys and mouse wheel; and rotate the camera with click-and-drag events.\n *  On a touch device, 1 finger swipe rotates the camera, and 2 fingers tranlsate/move the camera.\n *\n *\n *  Note: CSS property `touch-action: none` will probably be needed on listener element.\n *\n * See {@link three-story-controls#FreeMovementControlsProps} for all properties that can be passed to the constructor.\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/freemove | DEMO }\n *\n * @example\n * ```js\n * const scene = new Scene()\n * const camera = new PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)\n * const cameraRig = new CameraRig(camera, scene)\n * const controls = new FreeMovementControls(cameraRig)\n *\n * controls.enable()\n *\n * // render loop\n * function animate(t) {\n *  controls.update(t)\n * }\n * ```\n *\n */\nexport class FreeMovementControls implements BaseControls {\n  readonly cameraRig: CameraRig\n  private keyboardAdaptor: KeyboardAdaptor\n  private wheelAdaptor: WheelAdaptor\n  private pointerAdaptor: PointerAdaptor\n  private wheelScaleFactor: number\n  private pointerScaleFactor: number\n  private panDegreeFactor: number\n  private tiltDegreeFactor: number\n  private enabled = false\n\n  /** {@inheritDoc three-story-controls#FreeMovementControlsProps#} */\n  constructor(cameraRig: CameraRig, props: FreeMovementControlsProps = {}) {\n    this.cameraRig = cameraRig\n\n    this.wheelScaleFactor = props.wheelScaleFactor || defaultProps.wheelScaleFactor\n    this.pointerScaleFactor = props.pointerScaleFactor || defaultProps.pointerScaleFactor\n    this.panDegreeFactor = props.panDegreeFactor || defaultProps.panDegreeFactor\n    this.tiltDegreeFactor = props.tiltDegreeFactor || defaultProps.tiltDegreeFactor\n\n    this.keyboardAdaptor = new KeyboardAdaptor({\n      type: 'continuous',\n      dampingFactor: props.keyboardDampFactor || defaultProps.keyboardDampFactor,\n      incrementor: props.keyboardScaleFactor || defaultProps.keyboardScaleFactor,\n    })\n\n    this.wheelAdaptor = new WheelAdaptor({\n      type: 'continuous',\n      dampingFactor: props.wheelDampFactor || defaultProps.wheelDampFactor,\n      domElement: props.domElement || defaultProps.domElement,\n    })\n\n    this.pointerAdaptor = new PointerAdaptor({\n      domElement: props.domElement || defaultProps.domElement,\n      dampingFactor: props.pointerDampFactor || defaultProps.pointerDampFactor,\n    })\n\n    this.onWheel = this.onWheel.bind(this)\n    this.onKey = this.onKey.bind(this)\n    this.onPointer = this.onPointer.bind(this)\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  enable(): void {\n    this.wheelAdaptor.connect()\n    this.keyboardAdaptor.connect()\n    this.pointerAdaptor.connect()\n    this.wheelAdaptor.addEventListener('update', this.onWheel)\n    this.keyboardAdaptor.addEventListener('update', this.onKey)\n    this.pointerAdaptor.addEventListener('update', this.onPointer)\n    this.enabled = true\n  }\n\n  disable(): void {\n    this.wheelAdaptor.disconnect()\n    this.keyboardAdaptor.disconnect()\n    this.pointerAdaptor.disconnect()\n    this.wheelAdaptor.removeEventListener('update', this.onWheel)\n    this.keyboardAdaptor.removeEventListener('update', this.onKey)\n    this.pointerAdaptor.removeEventListener('update', this.onPointer)\n    this.enabled = false\n  }\n\n  private onWheel(event): void {\n    this.cameraRig.do(CameraAction.Dolly, event.deltas.y * this.wheelScaleFactor)\n    this.cameraRig.do(CameraAction.Truck, event.deltas.x * this.wheelScaleFactor)\n  }\n\n  private onKey(event): void {\n    this.cameraRig.do(CameraAction.Dolly, event.values.backward - event.values.forward)\n    this.cameraRig.do(CameraAction.Truck, event.values.right - event.values.left)\n    this.cameraRig.do(CameraAction.Pedestal, event.values.up - event.values.down)\n  }\n\n  private onPointer(event): void {\n    switch (event.pointerCount) {\n      case 1:\n        this.cameraRig.do(CameraAction.Pan, event.deltas.x * this.panDegreeFactor)\n        this.cameraRig.do(CameraAction.Tilt, event.deltas.y * this.tiltDegreeFactor)\n        break\n      case 2:\n        this.cameraRig.do(CameraAction.Dolly, -event.deltas.y * this.pointerScaleFactor)\n        this.cameraRig.do(CameraAction.Truck, -event.deltas.x * this.pointerScaleFactor)\n        break\n      default:\n        break\n    }\n  }\n\n  update(time: number): void {\n    if (this.enabled) {\n      this.keyboardAdaptor.update()\n      this.wheelAdaptor.update()\n      this.pointerAdaptor.update(time)\n    }\n  }\n}\n","import { BaseControls } from './BaseControls'\nimport { CameraRig } from '../CameraRig'\nimport { ScrollAdaptor } from '../adaptors/ScrollAdaptor'\n\n/**\n * ScrollActions provide a way to add custom callback hooks for specific parts of the scroll area\n */\nexport interface ScrollAction {\n  /** When to start the action, in %, px or vh. */\n  start: string\n  /** When to end the action, in %, px or vh. */\n  end: string\n  /** Callback with 0-1 progress when element is between start and end conditions.  */\n  callback: (progress: number) => void\n  /** @internal */\n  startPx: number\n  /** @internal */\n  endPx: number\n  /** @internal */\n  bufferedStartPx: number\n  /** @internal */\n  bufferedEndPx: number\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#ScrollControls} constructor\n */\nexport interface ScrollControlsProps {\n  /** Long DOM Element to observe */\n  scrollElement: HTMLElement\n  /** Offset to start registering scroll, in px or vh. Default starts when top of element is at bottom of viewport. */\n  startOffset?: string\n  /** Offset to end registering scroll, in px or vh. Default ends when bottom of element is at top of viewport. */\n  endOffset?: string\n  /** Value between 0 and 1. Defaults to 1 */\n  dampingFactor?: number\n  /** Buffer before and after element to start registering scroll. Number (percentage) between 0 and 1, defaults to 0.1 */\n  buffer?: number\n  /** When in the scroll to start the camera animation, can be specified in px, % or vh */\n  cameraStart?: string\n  /** When in the scroll to end the camera animation, can be specified in px, % or vh */\n  cameraEnd?: string\n  /** Array of ScrollActions for custom scroll hooks  */\n  scrollActions: ScrollAction[]\n}\n\nconst defaultProps: Partial<ScrollControlsProps> = {\n  startOffset: '0px',\n  endOffset: '0px',\n  dampingFactor: 1,\n  buffer: 0.1,\n  cameraStart: '0%',\n  cameraEnd: '100%',\n  scrollActions: [],\n}\n\nconst mapRange = (number, inMin, inMax, outMin, outMax): number => {\n  return Math.max(outMin, Math.min(outMax, (number - inMin) * ((outMax - outMin) / (inMax - inMin)) + outMin))\n}\n\n/**\n * Control scheme to scrub through the CameraRig's `AnimationClip` based on the scroll of a DOM Element\n * @remarks\n * Control scheme to scrub through the CameraRig's `AnimationClip` based on the scroll of a DOM Element.\n *  These controls expect to observe an element that is a few viewports long, and use the scroll distance to scrub through a camera animation.\n *  By default, the 'start' of the animation is when the element starts to be in view (ie the top of the element aligns with the bottom of the viewport),\n *  and the 'end' is when the element goes out of view (when the bottom of the elements aligns with the top of the viewport).\n *  These trigger points can be customised with the `cameraStart` and `cameraEnd` properties. Additional scroll-dependant procedures can also be defined through `scrollActions`.\n *\n *\n * See {@link three-story-controls#ScrollControlsProps} for all properties that can be passed to the constructor.\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/scroll-controls/ | DEMO }\n *\n * @example\n * ```js\n * const scene = new Scene()\n * const gltfLoader = new GLTFLoader()\n * const camera = new PerspectiveCamera()\n * const cameraRig = new CameraRig(camera, scene)\n * const controls = new ScrollControls(cameraRig, {\n *  scrollElement: document.querySelector('.scroller'),\n *  cameraStart: '12%',\n *  cameraEnd: '90%',\n *  scrollActions: [\n *    { start: '0%' , end: '10%', callback: e => fadeInElement(e) },\n *    { start: '85%' , end: '100%', callback: e => fadeOutElement(e) }\n *  ]\n * })\n *\n * function fadeInElement(progress) { // entry fade transition }\n * function fadeOutElement(progress) { // exit fade transition }\n *\n * gltfLoader.load(cameraPath, (gltf) => {\n *  cameraRig.setAnimationClip(gltf.animations[0])\n *  cameraRig.setAnimationTime(0)\n *  controls.enable()\n * })\n *\n * // render loop\n * function animate() {\n *  controls.update()\n * }\n * ```\n */\nexport class ScrollControls implements BaseControls {\n  readonly cameraRig: CameraRig\n  private scrollAdaptor: ScrollAdaptor\n  private enabled = false\n  private cameraStart: string\n  private cameraEnd: string\n  private cameraStartPx: number\n  private cameraEndPx: number\n  private cameraBufferedStartPx: number\n  private cameraBufferedEndPx: number\n  private scrollActions: ScrollAction[]\n  private buffer: number\n\n  constructor(cameraRig: CameraRig, props: ScrollControlsProps) {\n    this.cameraRig = cameraRig\n    this.cameraRig.setAnimationTime(0)\n\n    this.scrollAdaptor = new ScrollAdaptor({\n      scrollElement: props.scrollElement,\n      dampingFactor: props.dampingFactor || defaultProps.dampingFactor,\n      startOffset: props.startOffset || defaultProps.startOffset,\n      endOffset: props.endOffset || defaultProps.endOffset,\n      buffer: props.buffer || defaultProps.buffer,\n    })\n\n    this.cameraStart = props.cameraStart || defaultProps.cameraStart\n    this.cameraEnd = props.cameraEnd || defaultProps.cameraEnd\n    this.scrollActions = props.scrollActions || defaultProps.scrollActions\n    this.buffer = props.buffer || defaultProps.buffer\n    this.calculateStops()\n    this.onScroll = this.onScroll.bind(this)\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  enable(): void {\n    this.scrollAdaptor.connect()\n    this.scrollAdaptor.addEventListener('update', this.onScroll)\n    this.enabled = true\n  }\n\n  disable(): void {\n    this.scrollAdaptor.disconnect()\n    this.scrollAdaptor.removeEventListener('update', this.onScroll)\n    this.enabled = false\n  }\n\n  update(): void {\n    if (this.enabled) {\n      this.scrollAdaptor.update()\n    }\n  }\n\n  private calculateStops(): void {\n    this.cameraStartPx = this.scrollAdaptor.parseOffset(this.cameraStart)\n    this.cameraEndPx = this.scrollAdaptor.parseOffset(this.cameraEnd)\n    this.cameraBufferedStartPx = this.cameraStartPx * (1 - this.buffer)\n    this.cameraBufferedEndPx = this.cameraEndPx * (1 + this.buffer)\n    this.scrollActions.forEach((action) => {\n      action.startPx = this.scrollAdaptor.parseOffset(action.start)\n      action.endPx = this.scrollAdaptor.parseOffset(action.end)\n      action.bufferedStartPx = action.startPx * (1 - this.buffer)\n      action.bufferedEndPx = action.endPx * (1 + this.buffer)\n    })\n  }\n\n  private onScroll(event): void {\n    const progress = event.dampenedValues.scrollPx\n    if (progress >= this.cameraBufferedStartPx && progress <= this.cameraBufferedEndPx) {\n      this.cameraRig.setAnimationPercentage(mapRange(progress, this.cameraStartPx, this.cameraEndPx, 0, 1))\n    }\n    this.scrollActions.forEach((action) => {\n      if (progress >= action.bufferedStartPx && progress <= action.bufferedEndPx) {\n        action.callback(mapRange(progress, action.startPx, action.endPx, 0, 1))\n      }\n    })\n  }\n}\n","import { EventDispatcher, Vector3, Quaternion } from 'three'\nimport { BaseControls, UpdatePOIsEvent, ExitPOIsEvent } from './BaseControls'\nimport { KeyboardAdaptor } from '../adaptors/KeyboardAdaptor'\nimport { CameraRig } from '../CameraRig'\n\nexport interface StoryPointMarker {\n  /** Camera position */\n  position: Vector3\n  /** Camera quaternion */\n  quaternion: Quaternion\n  /** Transition duration, defaults to 1 */\n  duration?: number\n  /** Transition easing, defaults to power1 */\n  ease?: string\n  /** Use spherical interpolation for rotation, defaults to true */\n  useSlerp?: boolean\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#StoryPointsControls} constructor\n */\nexport interface StoryPointsControlsProps {\n  /** Whether to cycle to the first/last POI after reaching the end/start. When false, controls with emit 'ExitStoryPoints' events. Defaults to false. */\n  cycle?: boolean\n  /** Use keyboard arrow keys as navigation, defaults to true */\n  useKeyboard?: boolean\n}\n\nconst defaultProps: StoryPointsControlsProps = {\n  cycle: false,\n  useKeyboard: true,\n}\n\n/**\n * Control scheme to transition the camera between given points in world space.\n * @remarks\n * See {@link three-story-controls#StoryPointsControlsProps} for all properties that can be passed to the constructor.\n *\n * See {@link three-story-controls#StoryPointMarker} for POI properties.\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/story-points/ | DEMO }\n *\n * @example\n * ```js\n *\n * const pois = [\n *  { position: new Vector3(...), quaternion: new Quaternion(...) },\n *  { position: new Vector3(...), quaternion: new Quaternion(...) },\n * ]\n * const scene = new Scene()\n * const camera = new PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)\n * const cameraRig = new CameraRig(camera, scene)\n * const controls = new StoryPointsControls(cameraRig, pois)\n *\n * controls.enable()\n * controls.goToPOI(0)\n *\n * // Assuming DOM elements with classes 'nextBtn' and 'prevBtn' have been created\n * document.querySelector('.nextBtn').on('click', () => controls.nextPOI() )\n * document.querySelector('.prevBtn').on('click', () => controls.prevPOI() )\n * ```\n */\nexport class StoryPointsControls extends EventDispatcher implements BaseControls {\n  readonly cameraRig: CameraRig\n  private keyboardAdaptor: KeyboardAdaptor\n  private pois: StoryPointMarker[]\n  private currentIndex: number | null = null\n  private upcomingIndex: number | null = null\n  private enabled = false\n  private cycle: boolean\n  private useKeyboard: boolean\n\n  constructor(cameraRig: CameraRig, pois: StoryPointMarker[] = [], props: StoryPointsControlsProps = {}) {\n    super()\n    this.cameraRig = cameraRig\n    this.pois = pois\n    Object.assign(this, defaultProps, props)\n    if (this.useKeyboard) {\n      this.keyboardAdaptor = new KeyboardAdaptor({\n        type: 'discrete',\n        keyMapping: {\n          next: ['ArrowDown', 'ArrowRight'],\n          prev: ['ArrowUp', 'ArrowLeft'],\n        },\n      })\n      this.onKey = this.onKey.bind(this)\n    }\n    this.onCameraStart = this.onCameraStart.bind(this)\n    this.onCameraUpdate = this.onCameraUpdate.bind(this)\n    this.onCameraEnd = this.onCameraEnd.bind(this)\n  }\n\n  getCurrentIndex(): number {\n    return this.currentIndex\n  }\n\n  nextPOI(): void {\n    const next = this.currentIndex + 1\n    if (next >= this.pois.length && !this.cycle) {\n      this.dispatchEvent({\n        type: 'ExitPOIs',\n        exitFrom: 'end',\n      } as ExitPOIsEvent)\n    } else {\n      this.goToPOI(next % this.pois.length)\n    }\n  }\n\n  prevPOI(): void {\n    const prev = this.currentIndex - 1\n    if (prev < 0 && !this.cycle) {\n      this.dispatchEvent({\n        type: 'ExitPOIs',\n        exitFrom: 'start',\n      } as ExitPOIsEvent)\n    } else {\n      this.goToPOI((prev + this.pois.length) % this.pois.length)\n    }\n  }\n\n  goToPOI(index: number): void {\n    this.upcomingIndex = index\n    const poi = this.pois[this.upcomingIndex]\n    this.cameraRig.flyTo(poi.position, poi.quaternion, poi.duration, poi.ease, poi.useSlerp)\n  }\n\n  enable(): void {\n    if (this.useKeyboard) {\n      this.keyboardAdaptor.connect()\n      this.keyboardAdaptor.addEventListener('trigger', this.onKey)\n    }\n    this.cameraRig.addEventListener('CameraMoveStart', this.onCameraStart)\n    this.cameraRig.addEventListener('CameraMoveUpdate', this.onCameraUpdate)\n    this.cameraRig.addEventListener('CameraMoveEnd', this.onCameraEnd)\n    this.enabled = true\n  }\n\n  disable(): void {\n    if (this.useKeyboard) {\n      this.keyboardAdaptor.disconnect()\n      this.keyboardAdaptor.removeEventListener('trigger', this.onKey)\n    }\n    this.cameraRig.removeEventListener('CameraMoveStart', this.onCameraStart)\n    this.cameraRig.removeEventListener('CameraMoveUpdate', this.onCameraUpdate)\n    this.cameraRig.removeEventListener('CameraMoveEnd', this.onCameraEnd)\n    this.enabled = false\n  }\n\n  update(): void {\n    // nothing to do here\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  private updatePois(progress: number): void {\n    this.dispatchEvent({\n      type: 'update',\n      currentIndex: this.currentIndex,\n      upcomingIndex: this.upcomingIndex,\n      progress,\n    } as UpdatePOIsEvent)\n  }\n\n  private onCameraStart(): void {\n    this.updatePois(0)\n  }\n\n  private onCameraUpdate(event): void {\n    this.updatePois(event.progress)\n  }\n\n  private onCameraEnd(): void {\n    this.currentIndex = this.upcomingIndex\n    this.upcomingIndex = null\n  }\n\n  private onKey(event): void {\n    if (event.trigger === 'next') {\n      this.nextPOI()\n    } else if (event.trigger === 'prev') {\n      this.prevPOI()\n    }\n  }\n}\n","import { EventDispatcher } from 'three'\nimport { BaseControls, UpdatePOIsEvent, ExitPOIsEvent } from './BaseControls'\nimport { CameraRig } from '../CameraRig'\nimport { KeyboardAdaptor } from '../adaptors/KeyboardAdaptor'\nimport { WheelAdaptor } from '../adaptors/WheelAdaptor'\nimport { SwipeAdaptor } from '../adaptors/SwipeAdaptor'\n\nexport interface PathPointMarker {\n  frame: number\n}\n\n/**\n * Properties that can be passed to the {@link three-story-controls#PathPointsControls} constructor\n */\nexport interface PathPointsControlsProps {\n  /** Threshold of wheel delta that triggers a transition. Defaults to 15 */\n  wheelThreshold?: number\n  /** Threshold of swipe distance that triggers a transition. Defaults to 60 */\n  swipeThreshold?: number\n  /** Transition duration, defaults to 1 */\n  duration?: number\n  /** Transition easing, defaults to power1 */\n  ease?: string\n  /** Use keyboard arrow keys as navigation, defaults to true */\n  useKeyboard?: boolean\n}\n\nconst defaultProps: PathPointsControlsProps = {\n  wheelThreshold: 15,\n  swipeThreshold: 60,\n  duration: 1,\n  ease: 'power1',\n  useKeyboard: true,\n}\n\n/**\n * Control scheme to transition the camera between specific points (frames) along a path specified through an `AnimationClip`.\n * @remarks\n * Control scheme to transition the camera between specific points (frames) along a path specified through an `AnimationClip`.\n *  A mouse wheel or swipe or keyboard arrow event triggers the camera to smoothly transition from one given frame number to the next.\n *\n *\n * Note: CSS property `touch-action: none` will probably be needed on listener element.\n *\n * See {@link three-story-controls#PathPointsControlsProps} for all properties that can be passed to the constructor.\n *\n * See {@link three-story-controls#PathPointMarker} for POI properties.\n *\n * See {@link three-story-controls#UpdatePOIsEvent} and {@link three-story-controls#ExitPOIsEvent} for emitted event signatures.\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/path-points/ | DEMO }\n * @example\n * ```js\n *\n * const pois = [ { frame: 0 }, { frame: 54 } ....]\n * const scene = new Scene()\n * const gltfLoader = new GLTFLoader()\n * let camera, cameraRig, controls\n *\n * gltfLoader.load(cameraPath, (gltf) => {\n *  camera = gltf.cameras[0]\n *  cameraRig = new CameraRig(camera, scene)\n *  cameraRig.setAnimationClip(gltf.animations[0])\n *  cameraRig.setAnimationTime(0)\n *  controls = new PathPointsControls(cameraRig, pois)\n *  controls.enable()\n *  controls.addEventListener('ExitPOIs', (e) => {\n *    // e.exitFrom will be either 'start' or 'end'\n *  })\n *  controls.addEventListener('update', (e) => {\n *    // e.currentIndex will be the index of the starting poi\n *    // e.upcomingIndex will be the index of the upcoming poi\n *    // e.progress will be a number 0-1 indicating progress of the transition\n *  })\n * })\n * ```\n */\nexport class PathPointsControls extends EventDispatcher implements BaseControls {\n  readonly cameraRig: CameraRig\n  private wheelAdaptor: WheelAdaptor\n  private swipeAdaptor: SwipeAdaptor\n  private keyboardAdaptor: KeyboardAdaptor\n  private pois: PathPointMarker[]\n  private currentIndex = 0\n  private upcomingIndex: number | null = null\n  private enabled = false\n  private duration: number\n  private ease: string\n  private wheelThreshold: number\n  private swipeThreshold: number\n  private useKeyboard: boolean\n\n  constructor(cameraRig: CameraRig, pois: PathPointMarker[] = [], props: PathPointsControlsProps = {}) {\n    super()\n    this.cameraRig = cameraRig\n    this.pois = pois\n    Object.assign(this, defaultProps, props)\n    this.wheelAdaptor = new WheelAdaptor({ type: 'discrete', thresholdY: this.wheelThreshold })\n    this.swipeAdaptor = new SwipeAdaptor({ thresholdY: this.swipeThreshold })\n    if (this.useKeyboard) {\n      this.keyboardAdaptor = new KeyboardAdaptor({\n        type: 'discrete',\n        keyMapping: {\n          next: ['ArrowDown', 'ArrowRight'],\n          prev: ['ArrowUp', 'ArrowLeft'],\n        },\n      })\n      this.onKey = this.onKey.bind(this)\n    }\n    this.onCameraStart = this.onCameraStart.bind(this)\n    this.onCameraUpdate = this.onCameraUpdate.bind(this)\n    this.onCameraEnd = this.onCameraEnd.bind(this)\n    this.onTrigger = this.onTrigger.bind(this)\n  }\n\n  getCurrentIndex(): number {\n    return this.currentIndex\n  }\n\n  enable(): void {\n    if (this.useKeyboard) {\n      this.keyboardAdaptor.addEventListener('trigger', this.onKey)\n      this.keyboardAdaptor.connect()\n    }\n    this.wheelAdaptor.addEventListener('trigger', this.onTrigger)\n    this.swipeAdaptor.addEventListener('trigger', this.onTrigger)\n    this.cameraRig.addEventListener('CameraMoveStart', this.onCameraStart)\n    this.cameraRig.addEventListener('CameraMoveUpdate', this.onCameraUpdate)\n    this.cameraRig.addEventListener('CameraMoveEnd', this.onCameraEnd)\n    this.wheelAdaptor.connect()\n    this.swipeAdaptor.connect()\n    this.enabled = true\n  }\n\n  disable(): void {\n    if (this.useKeyboard) {\n      this.keyboardAdaptor.removeEventListener('trigger', this.onKey)\n      this.keyboardAdaptor.disconnect()\n    }\n    this.wheelAdaptor.removeEventListener('trigger', this.onTrigger)\n    this.swipeAdaptor.removeEventListener('trigger', this.onTrigger)\n    this.cameraRig.removeEventListener('CameraMoveStart', this.onCameraStart)\n    this.cameraRig.removeEventListener('CameraMoveUpdate', this.onCameraUpdate)\n    this.cameraRig.removeEventListener('CameraMoveEnd', this.onCameraEnd)\n    this.wheelAdaptor.disconnect()\n    this.swipeAdaptor.disconnect()\n    this.enabled = false\n  }\n\n  update(): void {\n    // nothing to do here\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  private onKey(event): void {\n    switch (event.trigger) {\n      case 'prev':\n        this.onTrigger({ y: -1 })\n        break\n      case 'next':\n        this.onTrigger({ y: 1 })\n        break\n      default:\n        break\n    }\n  }\n\n  private onTrigger(event): void {\n    const index = this.currentIndex + event.y\n    if (index >= this.pois.length) {\n      this.dispatchEvent({\n        type: 'ExitPOIs',\n        exitFrom: 'end',\n      } as ExitPOIsEvent)\n    } else if (index < 0) {\n      this.dispatchEvent({\n        type: 'ExitPOIs',\n        exitFrom: 'start',\n      } as ExitPOIsEvent)\n    } else {\n      this.upcomingIndex = index\n      this.cameraRig.flyToKeyframe(this.pois[this.upcomingIndex].frame, this.duration, this.ease)\n    }\n  }\n\n  private updatePois(progress: number): void {\n    this.dispatchEvent({\n      type: 'update',\n      currentIndex: this.currentIndex,\n      upcomingIndex: this.upcomingIndex,\n      progress,\n    } as UpdatePOIsEvent)\n  }\n\n  private onCameraStart(): void {\n    this.updatePois(0)\n  }\n\n  private onCameraUpdate(event): void {\n    this.updatePois(event.progress)\n  }\n\n  private onCameraEnd(): void {\n    this.currentIndex = this.upcomingIndex\n    this.upcomingIndex = null\n  }\n}\n","import { BaseControls } from './BaseControls'\nimport { CameraRig, CameraAction, RigComponent } from '../CameraRig'\nimport { PointerAdaptor } from '../adaptors/PointerAdaptor'\n\n/**\n * Properties that can be passed to the {@link three-story-controls#ThreeDOFControls} constructor\n */\n//TODO: add option for relative or absolute control (in terms of screen space)\nexport interface ThreeDOFControlsProps {\n  /** DOM element that should listen for pointer events. Defaults to `document.body` */\n  domElement?: HTMLElement\n  /** Mutiplier for panning. Defaults to Math.PI / 20 */\n  panFactor?: number\n  /** Mutiplier for tilting. Defaults to Math.PI / 20 */\n  tiltFactor?: number\n  /** Mutiplier for truck translation. Defaults to 1 */\n  truckFactor?: number\n  /** Mutiplier for pedestal translation. Defaults to 1 */\n  pedestalFactor?: number\n  /** Damping factor between 0 and 1. Defaults to 0.7 */\n  dampingFactor?: number\n}\n\nconst defaultProps: ThreeDOFControlsProps = {\n  domElement: document.body,\n  panFactor: Math.PI / 20,\n  tiltFactor: Math.PI / 20,\n  truckFactor: 1,\n  pedestalFactor: 1,\n  dampingFactor: 0.7,\n}\n\n/**\n * Control scheme for slight rotation and translation movement in response to mouse movements (designed to be used in conjunction with other control schemes)\n * @remarks\n * Note: CSS property `touch-action: none` will probably be needed on listener element\n *\n * See {@link three-story-controls#ThreeDOFControlsProps} for all properties that can be passed to the constructor.\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/story-points/ | DEMO w/ story points }\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/scroll-controls/ | DEMO w/ scroll controls}\n *\n * @example\n * ```js\n * const scene = new Scene()\n * const camera = new PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)\n * const cameraRig = new CameraRig(camera, scene)\n * const controls = new ThreeDOFControls(cameraRig)\n *\n * controls.enable()\n *\n * // render loop\n * function animate(t) {\n *  controls.update(t)\n * }\n * ```\n */\nexport class ThreeDOFControls implements BaseControls {\n  readonly cameraRig: CameraRig\n  private pointerAdaptor: PointerAdaptor\n  private enabled = false\n  private panFactor: number\n  private tiltFactor: number\n  private truckFactor: number\n  private pedestalFactor: number\n\n  constructor(cameraRig: CameraRig, props: ThreeDOFControlsProps = {}) {\n    this.cameraRig = cameraRig\n    Object.assign(this, defaultProps, props)\n    this.pointerAdaptor = new PointerAdaptor({\n      domElement: props.domElement || defaultProps.domElement,\n      dampingFactor: props.dampingFactor || defaultProps.dampingFactor,\n    })\n    this.onPointerMove = this.onPointerMove.bind(this)\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  enable(): void {\n    this.pointerAdaptor.connect()\n    this.pointerAdaptor.addEventListener('update', this.onPointerMove)\n    this.enabled = true\n  }\n\n  disable(): void {\n    this.pointerAdaptor.disconnect()\n    this.pointerAdaptor.removeEventListener('update', this.onPointerMove)\n    this.enabled = false\n  }\n\n  update(time: number): void {\n    if (this.enabled) {\n      this.pointerAdaptor.update(time)\n    }\n  }\n\n  private onPointerMove(event): void {\n    if (event.pointerCount === 0) {\n      this.cameraRig.do(CameraAction.Pan, -event.deltas.x * this.panFactor, RigComponent.Eyes)\n      this.cameraRig.do(CameraAction.Tilt, -event.deltas.y * this.tiltFactor, RigComponent.Eyes)\n      this.cameraRig.do(CameraAction.Truck, event.deltas.x * this.truckFactor, RigComponent.Eyes)\n      this.cameraRig.do(CameraAction.Pedestal, event.deltas.y * this.pedestalFactor, RigComponent.Eyes)\n    }\n  }\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { Quaternion, Vector3, AnimationClip, VectorKeyframeTrack, QuaternionKeyframeTrack } from 'three'\nimport gsap from 'gsap'\nimport { CameraRig } from '../CameraRig'\nimport { FreeMovementControls } from '../controlschemes/FreeMovementControls'\nimport './index.css'\n\nconst easeFunctions = ['none', 'power1', 'power2', 'power3', 'power4', 'sine', 'expo', 'circ']\n\ninterface POI {\n  position: Vector3\n  quaternion: Quaternion\n  duration: number\n  ease: string\n  image: string\n}\n\nconst DOMClass = {\n  visit: 'visit',\n  remove: 'remove',\n  duration: 'duration',\n  ease: 'ease',\n  moveUp: 'move-up',\n  moveDown: 'move-down',\n}\n\n/**\n * A helper tool for creating camera animation paths and/or choosing camera look-at positions for points of interest in a scene\n *\n * @remarks\n * A helper tool for creating camera animation paths and/or choosing camera look-at positions for points of interest in a scene.\n *\n * The `CameraHelper` can be set up with any scene along with {@link three-story-controls#FreeMovementControls | FreeMovementControls}.\n *\n * It renders as an overlay with functionality to add/remove/reorders points of interest, and create an animation path between them.\n *  Each saved camera position is displayed with an image on the `CameraHelper` panel.\n *\n * The data can be exported as a JSON file that can then be used with different control schemes.\n *\n * {@link https://nytimes.github.io/three-story-controls/examples/demos/camera-helper | DEMO }\n *\n * @example\n * Here's an example of initializing the CameraHelper\n * ```js\n * const scene = new Scene()\n * const camera = new PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)\n * const cameraRig = new CameraRig(camera, scene)\n * const controls = new FreeMovementControls(cameraRig)\n *\n * controls.enable()\n *\n * const cameraHelper = new CameraHelper(rig, controls, renderer.domElement)\n *\n * // Render loop\n * // To allow for capturing an image of the canvas,\n * // it's important to update the CameraHelper after the scene is rendered,\n * // but before requesting the animation frame\n * function render(t) {\n *   controls.update(t)\n *   renderer.render(scene, camera)\n *   cameraHelper.update(t)\n *   window.requestAnimationFrame(render)\n * }\n *\n * render()\n * ```\n *\n *\n *\n * The following examples demonstrate using the exported data. Note: Depending on your setup, you may need to change the .json extension to .js and prepend the text with `export default` such that you can import it as javascript\n *\n * @example\n * Here's an example using the exported JSON data with ScrollControls.\n * ```javascript\n * import * as cameraData from 'camera-control.json'\n * const scene = new Scene()\n * const gltfLoader = new GLTFLoader()\n * const camera = new PerspectiveCamera()\n * const cameraRig = new CameraRig(camera, scene)\n *\n * // Parse the JSON animation clip\n * cameraRig.setAnimationClip(AnimationClip.parse(cameraData.animationClip))\n * cameraRig.setAnimationTime(0)\n *\n * const controls = new ScrollControls(cameraRig, {\n *  scrollElement: document.querySelector('.scroller'),\n * })\n *\n * controls.enable()\n *\n * function render(t) {\n *   window.requestAnimationFrame(render)\n *   if (rig.hasAnimation) {\n *     controls.update(t)\n *   }\n *   renderer.render(scene, camera)\n * }\n * ```\n *\n * @example\n * Here's an example using the exported data with Story Point controls\n * ```javascript\n * import * as cameraData from 'camera-control.json'\n * const scene = new Scene()\n * const gltfLoader = new GLTFLoader()\n * const camera = new PerspectiveCamera()\n * const cameraRig = new CameraRig(camera, scene)\n *\n * // Format the exported data to create three.js Vector and Quaternions\n * const pois = cameraData.pois.map((poi, i) => {\n *   return {\n *     position: new Vector3(...poi.position),\n *     quaternion: new Quaternion(...poi.quaternion),\n *     duration: poi.duration,\n *     ease: poi.ease,\n *   }\n * })\n *\n * const controls = new StoryPointsControls(rig, pois)\n * controls.enable()\n *\n * function render(t) {\n *   window.requestAnimationFrame(render)\n *   controls.update(t)\n *   renderer.render(scene, camera)\n * }\n * ```\n */\nexport class CameraHelper {\n  readonly rig: CameraRig\n  readonly controls: FreeMovementControls\n  readonly canvas: HTMLCanvasElement\n  private pois: POI[]\n  private currentIndex: number | null\n  private drawer: HTMLElement\n  private domList: HTMLElement\n  private collapseBtn: HTMLElement\n  private fileInput: HTMLInputElement\n  private btnImport: HTMLElement\n  private doCapture: boolean\n  private animationClip: AnimationClip\n  private isPlaying: boolean\n  private playStartTime: number\n  private useSlerp = true\n\n  constructor(rig: CameraRig, controls: FreeMovementControls, canvas: HTMLCanvasElement, canvasParent?: HTMLElement) {\n    this.rig = rig\n    this.controls = controls\n    this.canvas = canvas\n    this.pois = []\n    this.currentIndex = null\n    this.doCapture = false\n    this.isPlaying = false\n    this.initUI(canvasParent)\n  }\n\n  private capture(): void {\n    this.doCapture = true\n  }\n\n  update(time: number): void {\n    if (this.doCapture) {\n      const canvas = document.createElement('canvas')\n      const ctx = canvas.getContext('2d')\n      canvas.width = 640\n      canvas.height = 360\n      ctx.drawImage(this.canvas, 0, 0, canvas.width, canvas.height)\n      const image = canvas.toDataURL()\n\n      this.addPoi(image)\n      this.doCapture = false\n    }\n    if (this.isPlaying) {\n      if (!this.playStartTime) {\n        this.playStartTime = time\n        this.controls.disable()\n        this.rig.packTransform()\n      }\n      const t = (time - this.playStartTime) / 1000\n      this.rig.setAnimationTime(t)\n      if (t > this.animationClip.duration) {\n        this.isPlaying = false\n        this.playStartTime = null\n        this.controls.enable()\n        this.rig.unpackTransform()\n      }\n    }\n  }\n\n  private addPoi(image: string): void {\n    this.pois.push({\n      ...this.rig.getWorldCoordinates(),\n      duration: 1,\n      ease: 'power1',\n      image,\n    })\n    this.currentIndex = this.pois.length - 1\n    this.createClip()\n    this.render()\n  }\n\n  private updatePoi(index: number, props: Partial<POI>): void {\n    this.pois[index] = {\n      ...this.pois[index],\n      ...props,\n    }\n  }\n\n  private movePoi(index: number, direction: number): void {\n    if (index + direction >= 0 && index + direction < this.pois.length) {\n      const temp = this.pois[index]\n      this.pois[index] = this.pois[index + direction]\n      this.pois[index + direction] = temp\n      this.render()\n    }\n  }\n\n  private removePoi(index: number): void {\n    this.pois.splice(index, 1)\n    this.render()\n  }\n\n  private goToPoi(index: number): void {\n    const poi = this.pois[index]\n    this.rig.flyTo(poi.position, poi.quaternion, poi.duration, poi.ease, this.useSlerp)\n  }\n\n  private createClip(): void {\n    if (this.pois.length > 0) {\n      const times = []\n      const positionValues = []\n      const quaternionValues = []\n      const tmpPosition = new Vector3()\n      const tmpQuaternion = new Quaternion()\n      const framesPerPoi = 10\n\n      let tweenStartTime = 0\n\n      // transform imported arrays to quaternions and vector3 when loading a camera file\n      if (!this.pois[0].quaternion.isQuaternion && !this.pois[0].position.isVector3) {\n        for (let i = 0; i < this.pois.length; i++) {\n          const p = this.pois[i]\n          p.quaternion = new Quaternion(p.quaternion[0], p.quaternion[1], p.quaternion[2], p.quaternion[3])\n          p.position = new Vector3(p.position[0], p.position[1], p.position[2])\n        }\n      }\n\n      for (let i = 0; i < this.pois.length - 1; i++) {\n        const p1 = this.pois[i]\n        const p2 = this.pois[i + 1]\n\n        const values = {\n          px: p1.position.x,\n          py: p1.position.y,\n          pz: p1.position.z,\n          qx: p1.quaternion.x,\n          qy: p1.quaternion.y,\n          qz: p1.quaternion.z,\n          qw: p1.quaternion.w,\n          slerpAmount: 0,\n        }\n\n        const target = {\n          px: p2.position.x,\n          py: p2.position.y,\n          pz: p2.position.z,\n          qx: p2.quaternion.x,\n          qy: p2.quaternion.y,\n          qz: p2.quaternion.z,\n          qw: p2.quaternion.w,\n          slerpAmount: 1,\n          duration: p2.duration,\n          ease: p2.ease,\n        }\n\n        const tween = gsap.to(values, target)\n\n        for (let j = 0; j < framesPerPoi; j++) {\n          const lerpAmount = p2.duration * (j / framesPerPoi)\n          times.push(tweenStartTime + lerpAmount)\n          tween.seek(lerpAmount)\n          if (this.useSlerp) {\n            tmpQuaternion.slerpQuaternions(p1.quaternion, p2.quaternion, values.slerpAmount)\n          } else {\n            tmpQuaternion.set(values.qx, values.qy, values.qz, values.qw)\n          }\n          tmpPosition.set(values.px, values.py, values.pz)\n          tmpQuaternion.toArray(quaternionValues, quaternionValues.length)\n          tmpPosition.toArray(positionValues, positionValues.length)\n        }\n        tweenStartTime += p2.duration\n      }\n      // add last point\n      const last = this.pois[this.pois.length - 1]\n      last.quaternion.toArray(quaternionValues, quaternionValues.length)\n      last.position.toArray(positionValues, positionValues.length)\n      times.push(tweenStartTime)\n      this.animationClip = new AnimationClip(null, tweenStartTime, [\n        new VectorKeyframeTrack('Translation.position', times, positionValues),\n        new QuaternionKeyframeTrack('Rotation.quaternion', times, quaternionValues),\n      ])\n      this.rig.setAnimationClip(this.animationClip)\n    }\n  }\n\n  private scrubClip(amount: number): void {\n    if (this.pois.length > 0) {\n      this.rig.setAnimationPercentage(amount)\n    }\n  }\n\n  private playClip(): void {\n    if (this.pois.length > 0) {\n      this.isPlaying = true\n    }\n  }\n\n  private import(): void {\n    if (this.fileInput) {\n      this.fileInput.click()\n      const reader = new FileReader()\n\n      this.fileInput.onchange = () => {\n        reader.readAsText(this.fileInput.files[0])\n        reader.onload = (e) => {\n          const parsed = JSON.parse(<string>e.target.result)\n          this.pois = parsed.pois\n          this.animationClip = parsed.animationClip\n          this.createClip()\n          this.render()\n        }\n      }\n    }\n  }\n\n  private export({ draft }): void {\n    if (this.pois.length > 0) {\n      const jsondata = {} as any\n      jsondata.pois = this.pois.map((poi) => {\n        const position = [poi.position.x, poi.position.y, poi.position.z]\n        const quaternion = [poi.quaternion.x, poi.quaternion.y, poi.quaternion.z, poi.quaternion.w]\n        const obj = {\n          position,\n          quaternion,\n          duration: poi.duration,\n          ease: poi.ease,\n        } as any\n\n        if (draft) {\n          obj.image = poi.image\n        }\n\n        return obj\n      })\n      if (this.animationClip) {\n        jsondata.animationClip = AnimationClip.toJSON(this.animationClip)\n      }\n      const data = 'text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(jsondata))\n      const a = document.createElement('a')\n      a.href = 'data:' + data\n      a.download = `camera-data${draft ? '-draft' : ''}.json`\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    }\n  }\n\n  private exportImages(): void {\n    const link = document.createElement('a')\n    document.body.appendChild(link)\n    this.pois.forEach((poi, index) => {\n      link.href = poi.image\n      link.download = `camera-poi-${index}.png`\n      link.click()\n    })\n    link.remove()\n  }\n\n  // ui\n\n  private initUI(canvasParent?: HTMLElement): void {\n    this.drawer = document.createElement('div')\n    this.drawer.classList.add('tb-ch')\n\n    const btnAdd = document.createElement('button')\n    btnAdd.classList.add('btn-round', 'add')\n    btnAdd.innerText = '+'\n    btnAdd.onclick = this.capture.bind(this)\n\n    this.collapseBtn = document.createElement('button')\n    this.collapseBtn.classList.add('btn-round', 'collapse')\n    this.collapseBtn.innerText = '<'\n    this.collapseBtn.onclick = this.collapse.bind(this)\n\n    const controlWrapper = document.createElement('div')\n    controlWrapper.classList.add('controls')\n\n    this.fileInput = document.createElement('input')\n    this.fileInput.type = 'file'\n    this.fileInput.id = 'import'\n    this.fileInput.accept = 'application/json'\n    this.fileInput.style.display = 'none'\n\n    this.btnImport = document.createElement('button')\n    this.btnImport.classList.add('btn-text', 'import')\n    this.btnImport.innerText = 'import draft JSON'\n    this.btnImport.onclick = this.import.bind(this)\n\n    const btnExportImages = document.createElement('button')\n    btnExportImages.classList.add('btn-text', 'export')\n    btnExportImages.innerText = 'export draft JSON'\n    btnExportImages.onclick = this.export.bind(this, { draft: true })\n\n    const btnExport = document.createElement('button')\n    btnExport.classList.add('btn-text', 'export')\n    btnExport.innerText = 'export production JSON'\n    btnExport.onclick = this.export.bind(this, { draft: false })\n\n    const bntExportImages = document.createElement('button')\n    bntExportImages.classList.add('btn-text', 'export-images')\n    bntExportImages.innerHTML = 'export images'\n    bntExportImages.onclick = this.exportImages.bind(this)\n\n    const btnPlay = document.createElement('button')\n    btnPlay.classList.add('btn-text', 'play')\n    btnPlay.innerText = 'play'\n    btnPlay.onclick = this.playClip.bind(this)\n\n    const sliderTime: HTMLInputElement = document.createElement('input')\n    sliderTime.type = 'range'\n    sliderTime.min = '0'\n    sliderTime.max = '1000'\n    sliderTime.step = '0.1'\n    sliderTime.value = '0'\n    const updateTime = this.scrubClip.bind(this)\n    sliderTime.onmousedown = () => this.rig.packTransform()\n    sliderTime.onmouseup = () => this.rig.unpackTransform()\n    sliderTime.oninput = (e) => updateTime(parseInt((<HTMLInputElement>e.target).value) / 1000)\n\n    this.domList = document.createElement('div')\n    this.domList.classList.add('pois')\n    this.domList.onclick = this.handleEvents.bind(this)\n    this.domList.onchange = this.handleEvents.bind(this)\n\n    controlWrapper.append(\n      this.fileInput,\n      this.btnImport,\n      btnPlay,\n      sliderTime,\n      bntExportImages,\n      btnExportImages,\n      btnExport,\n    )\n    this.drawer.append(btnAdd, this.collapseBtn, this.domList, controlWrapper)\n\n    const parent = canvasParent || document.body\n    parent.append(this.drawer)\n  }\n\n  private handleEvents(event): void {\n    const index = event.target.dataset.index\n    if (index) {\n      if (event.target.classList.contains(DOMClass.visit)) {\n        this.goToPoi(parseInt(index))\n      } else if (event.target.classList.contains(DOMClass.remove)) {\n        this.removePoi(parseInt(index))\n      } else if (event.target.classList.contains(DOMClass.duration)) {\n        this.updatePoi(parseInt(index), { duration: parseFloat((<HTMLInputElement>event.target).value) })\n      } else if (event.target.classList.contains(DOMClass.ease)) {\n        this.updatePoi(parseInt(index), { ease: (<HTMLSelectElement>event.target).value })\n      } else if (event.target.classList.contains(DOMClass.moveUp)) {\n        this.movePoi(parseInt(index), -1)\n      } else if (event.target.classList.contains(DOMClass.moveDown)) {\n        this.movePoi(parseInt(index), 1)\n      }\n      this.createClip()\n    }\n  }\n\n  private collapse(): void {\n    if (this.drawer.classList.contains('collapsed')) {\n      this.drawer.classList.remove('collapsed')\n      this.collapseBtn.innerText = '<'\n    } else {\n      this.drawer.classList.add('collapsed')\n      this.collapseBtn.innerText = '>'\n    }\n  }\n\n  private render(): void {\n    this.domList.innerHTML = ''\n    this.pois.forEach((poi, index) => {\n      const div = document.createElement('div')\n      div.classList.add('poi')\n\n      const textHeading = document.createElement('h2')\n      textHeading.innerText = `${index + 1}.`\n\n      const wrapper = document.createElement('div')\n      wrapper.classList.add('wrapper')\n      const controls = document.createElement('div')\n      controls.classList.add('poi-controls')\n      const params = document.createElement('div')\n      params.classList.add('poi-params')\n\n      const image = new Image()\n      image.src = poi.image\n\n      const labelDuration = document.createElement('label')\n      labelDuration.innerText = 'Duration'\n      const inputDuration = document.createElement('input')\n      inputDuration.classList.add(DOMClass.duration)\n      inputDuration.dataset.index = `${index}`\n      inputDuration.type = 'number'\n      inputDuration.value = String(poi.duration)\n\n      const labelEase = document.createElement('label')\n      labelEase.innerText = 'Easing'\n      const selectEase = document.createElement('select')\n      selectEase.classList.add(DOMClass.ease)\n      selectEase.dataset.index = `${index}`\n      const options = easeFunctions.map((x) => {\n        const op = document.createElement('option')\n        op.innerText = x\n        op.value = x\n        op.selected = x === poi.ease\n        return op\n      })\n      selectEase.append(...options)\n\n      const btnRemove = document.createElement('button')\n      btnRemove.classList.add(DOMClass.remove)\n      btnRemove.title = 'Remove'\n      btnRemove.dataset.index = `${index}`\n      btnRemove.innerText = 'x'\n\n      const btnVisit = document.createElement('button')\n      btnVisit.classList.add(DOMClass.visit)\n      btnVisit.title = 'Visit'\n      btnVisit.dataset.index = `${index}`\n      btnVisit.innerHTML = '&rarr;'\n\n      const btnMoveUp = document.createElement('button')\n      btnMoveUp.classList.add(DOMClass.moveUp)\n      btnMoveUp.title = 'Move up'\n      btnMoveUp.dataset.index = `${index}`\n      btnMoveUp.innerHTML = '&uarr;'\n\n      const btnMoveDown = document.createElement('button')\n      btnMoveDown.classList.add(DOMClass.moveDown)\n      btnMoveDown.title = 'Move down'\n      btnMoveDown.dataset.index = `${index}`\n      btnMoveDown.innerHTML = '&darr;'\n\n      controls.append(btnRemove, btnVisit, btnMoveUp, btnMoveDown)\n      params.append(labelDuration, inputDuration, labelEase, selectEase)\n      wrapper.append(image, controls)\n      div.append(textHeading, wrapper, params)\n      this.domList.appendChild(div)\n    })\n  }\n}\n"],"names":["CameraAction","RigComponent","Axis","Vector3","EventDispatcher","Object3D","PerspectiveCamera","Quaternion","Euler","AnimationMixer","gsap","defaultProps","AnimationClip","VectorKeyframeTrack","QuaternionKeyframeTrack"],"mappings":";;;;;;;;;;IAcA;;;;;;;;;;;;;;;UAgBa,MAAM;QAQjB,YAAY,KAAkB;YANtB,YAAO,GAAG,KAAK,CAAA;YACf,WAAM,GAAiB,EAAE,CAAA;YACzB,iBAAY,GAAiB,EAAE,CAAA;YAC/B,gBAAW,GAAiB,EAAE,CAAA;YAIpC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,CAAA;YACxC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,MAAM,CAAC,CAAA;YAC9C,IAAI,CAAC,WAAW,GAAG,EAAE,CAAA;YACrB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;gBAC7B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;aAC1B;YACD,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC,aAAa,CAAA;YACxC,IAAI,KAAK,CAAC,OAAO;gBAAE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAA;YAC/C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA;SACvB;;;;QAKD,MAAM;YACJ,MAAM,MAAM,GAAG,EAAE,CAAA;YACjB,IAAI,UAAU,GAAG,IAAI,CAAA;YAErB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;gBAC7B,MAAM,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;gBACvD,UAAU,GAAG,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAA;aAChE;YAED,IAAI,UAAU,EAAE;gBACd,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;oBAC7B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;oBACnC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAA;iBAC1C;gBACD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA;aACvB;iBAAM;gBACL,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;oBAC7B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;oBACxD,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAA;iBAC1C;aACF;SACF;;;;;QAMD,SAAS,CAAC,MAAoB;YAC5B,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;gBACxB,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;aACrC;YACD,IAAI,CAAC,UAAU,GAAG,KAAK,CAAA;SACxB;;;;;;QAOD,WAAW,CAAC,GAAW,EAAE,KAAa;YACpC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,KAAK,CAAA;YAC/B,IAAI,CAAC,UAAU,GAAG,KAAK,CAAA;SACxB;;;;;QAMD,QAAQ,CAAC,KAAa;YACpB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;gBAC7B,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,KAAK,CAAA;gBAC9B,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAA;gBACxB,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;aAC1B;YACD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA;SACvB;;;;;QAMD,SAAS,CAAC,MAAoB;YAC5B,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;gBACxB,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;gBACpC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;gBAC9B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;aAC1B;YACD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA;SACvB;;;;;QAMD,gBAAgB;YACd,yBAAY,IAAI,CAAC,MAAM,EAAE;SAC1B;;;;;QAMD,cAAc;YACZ,yBAAY,IAAI,CAAC,WAAW,EAAE;SAC/B;;;;;QAMD,aAAa;YACX,OAAO,IAAI,CAAC,UAAU,CAAA;SACvB;;;IC/FH;;;AAGYA;IAAZ,WAAY,YAAY;QACtB,2BAAW,CAAA;QACX,6BAAa,CAAA;QACb,6BAAa,CAAA;QACb,+BAAe,CAAA;QACf,qCAAqB,CAAA;QACrB,+BAAe,CAAA;QACf,6BAAa,CAAA;IACf,CAAC,EARWA,oBAAY,KAAZA,oBAAY,QAQvB;IAED;;;AAGYC;IAAZ,WAAY,YAAY;QACtB,6BAAa,CAAA;QACb,6BAAa,CAAA;QACb,6BAAa,CAAA;IACf,CAAC,EAJWA,oBAAY,KAAZA,oBAAY,QAIvB;IAED;;;AAGYC;IAAZ,WAAY,IAAI;QACd,eAAO,CAAA;QACP,eAAO,CAAA;QACP,eAAO,CAAA;IACT,CAAC,EAJWA,YAAI,KAAJA,YAAI,QAIf;IAoBD,MAAM,UAAU,GAAG;QACjB,CAACA,YAAI,CAAC,CAAC,GAAG,IAAIC,aAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,CAACD,YAAI,CAAC,CAAC,GAAG,IAAIC,aAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,CAACD,YAAI,CAAC,CAAC,GAAG,IAAIC,aAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;KAC/B,CAAA;IAED,MAAM,qBAAqB,GAAG;QAC5B,CAACD,YAAI,CAAC,CAAC,GAAG;YACR,CAACF,oBAAY,CAAC,GAAG,GAAGE,YAAI,CAAC,CAAC;YAC1B,CAACF,oBAAY,CAAC,IAAI,GAAGE,YAAI,CAAC,CAAC;YAC3B,CAACF,oBAAY,CAAC,IAAI,GAAGE,YAAI,CAAC,CAAC;SAC5B;QACD,CAACA,YAAI,CAAC,CAAC,GAAG;YACR,CAACF,oBAAY,CAAC,GAAG,GAAGE,YAAI,CAAC,CAAC;YAC1B,CAACF,oBAAY,CAAC,IAAI,GAAGE,YAAI,CAAC,CAAC;YAC3B,CAACF,oBAAY,CAAC,IAAI,GAAGE,YAAI,CAAC,CAAC;SAC5B;QACD,CAACA,YAAI,CAAC,CAAC,GAAG;YACR,CAACF,oBAAY,CAAC,GAAG,GAAGE,YAAI,CAAC,CAAC;YAC1B,CAACF,oBAAY,CAAC,IAAI,GAAGE,YAAI,CAAC,CAAC;YAC3B,CAACF,oBAAY,CAAC,IAAI,GAAGE,YAAI,CAAC,CAAC;SAC5B;KACF,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAkCa,SAAU,SAAQE,qBAAe;;QAuB5C,YAAY,MAAc,EAAE,KAAY;YACtC,KAAK,EAAE,CAAA;YAjBD,cAAS,GAAG,KAAK,CAAA;YACjB,WAAM,GAASF,YAAI,CAAC,CAAC,CAAA;YACrB,eAAU,GAAe,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;YAC3D,iBAAY,GAAG,KAAK,CAAA;YAGpB,mCAA8B,GAAG,aAAa,CAAA;YAC9C,gCAA2B,GAAG,UAAU,CAAA;YAEzC,mBAAc,GAAmB;gBACtC,CAACF,oBAAY,CAAC,IAAI,GAAG,KAAK;gBAC1B,CAACA,oBAAY,CAAC,GAAG,GAAG,IAAI;gBACxB,CAACA,oBAAY,CAAC,IAAI,GAAG,KAAK;aAC3B,CAAA;YAKC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;YACpB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;YAClB,IAAI,CAAC,IAAI,GAAG,IAAIK,cAAQ,EAAE,CAAA;YAC1B,IAAI,CAAC,IAAI,GAAG,IAAIA,cAAQ,EAAE,CAAA;YAC1B,IAAI,CAAC,IAAI,GAAG,IAAIA,cAAQ,EAAE,CAAA;YAC1B,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,2BAA2B,CAAA;YACjD,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,8BAA8B,CAAA;YACpD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;YAClD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;YAClD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;YAClD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;YACxE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;YACzB,IAAI,CAAC,eAAe,EAAE,CAAA;SACvB;;;;;;QAOD,UAAU,CAAC,MAAoB;YAC7B,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA;SAC/B;;;;;;QAOD,gBAAgB,CAAC,MAAoB;YACnC,OAAO,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAA;SAC3C;;;;;;;QAQD,EAAE,CAAC,MAAoB,EAAE,MAAc,EAAE,YAA2B;YAClE,MAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,CAAA;YAE1C,QAAQ,MAAM;gBACZ,KAAKL,oBAAY,CAAC,GAAG,CAAC;gBACtB,KAAKA,oBAAY,CAAC,IAAI,CAAC;gBACvB,KAAKA,oBAAY,CAAC,IAAI,EAAE;oBACtB,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAA;oBAC1C,IAAI,eAAe,EAAE;wBACnB,eAAe,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;qBAC3C;yBAAM,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;wBACtC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;qBACrC;yBAAM;wBACL,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;qBACrC;oBACD,MAAK;iBACN;gBAED,KAAKA,oBAAY,CAAC,KAAK,EAAE;oBACvB,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAACA,oBAAY,CAAC,IAAI,CAAC,CAAA;oBACrD,MAAM,SAAS,GAAG,eAAe,IAAI,IAAI,CAAC,IAAI,CAAA;oBAC9C,SAAS,CAAC,eAAe,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;oBACvC,MAAK;iBACN;gBAED,KAAKA,oBAAY,CAAC,QAAQ,EAAE;oBAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAACA,oBAAY,CAAC,GAAG,CAAC,CAAA;oBACpD,MAAM,SAAS,GAAG,eAAe,IAAI,IAAI,CAAC,IAAI,CAAA;oBAC9C,SAAS,CAAC,eAAe,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;oBACvC,MAAK;iBACN;gBAED,KAAKA,oBAAY,CAAC,KAAK,EAAE;oBACvB,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAACA,oBAAY,CAAC,IAAI,CAAC,CAAA;oBACrD,MAAM,SAAS,GAAG,eAAe,IAAI,IAAI,CAAC,IAAI,CAAA;oBAC9C,SAAS,CAAC,eAAe,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;oBACvC,MAAK;iBACN;gBAED,KAAKA,oBAAY,CAAC,IAAI,EAAE;oBACtB,IAAI,IAAI,CAAC,MAAM,YAAYM,uBAAiB,EAAE;wBAC5C,IAAI,CAAC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAA;wBACxB,IAAI,CAAC,MAAM,CAAC,sBAAsB,EAAE,CAAA;qBACrC;oBACD,MAAK;iBACN;aAIF;SACF;;;;QAKD,mBAAmB;YACjB,MAAM,QAAQ,GAAG,IAAIH,aAAO,EAAE,CAAA;YAC9B,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAA;YACtC,MAAM,UAAU,GAAG,IAAII,gBAAU,EAAE,CAAA;YACnC,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAA;YAC1C,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAA;SAChC;;;;;QAMD,mBAAmB,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAiD;YACzF,MAAM,eAAe,GAAG,IAAIC,WAAK,EAAE,CAAC,iBAAiB,CAAC,UAAU,EAAE,IAAI,CAAC,gBAAgB,EAAE,CAAC,CAAA;YAC1F,MAAM,OAAO,GAAG,CAACR,oBAAY,CAAC,GAAG,EAAEA,oBAAY,CAAC,IAAI,EAAEA,oBAAY,CAAC,IAAI,CAAC,CAAA;YACxE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;YACjC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM;gBACrB,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA;gBACpC,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;oBAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,eAAe,CAAC,IAAI,CAAC,CAAA;iBACjD;qBAAM;oBACL,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,eAAe,CAAC,IAAI,CAAC,CAAA;iBACjD;aACF,CAAC,CAAA;YACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YACjC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;SAClC;;;;;QAMD,aAAa;YACX,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;YAC3D,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;YACjC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;YACrC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;SAChC;;;;;QAMD,eAAe;YACb,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;YAC3D,IAAI,CAAC,mBAAmB,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAA;SACnD;;;;QAKD,WAAW;YACT,IAAI,IAAI,CAAC,aAAa,EAAE;gBACtB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;gBAC9B,IAAI,CAAC,aAAa,GAAG,KAAK,CAAA;aAC3B;SACF;;;;QAKD,QAAQ;YACN,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACvB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;gBAC7B,IAAI,CAAC,eAAe,EAAE,CAAA;gBACtB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;aAC1B;SACF;;;;QAKD,gBAAgB;YACd,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAA;SAC7D;;;;QAKD,OAAO;YACL,OAAO,IAAI,CAAC,aAAa,CAAA;SAC1B;;;;QAKD,QAAQ;YACN,OAAO,IAAI,CAAC,SAAS,CAAA;SACtB;;;;;QAMD,SAAS,CAAC,IAAU;YAClB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;YAClB,IAAI,CAAC,UAAU,GAAG,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;YACpD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;SACnD;;;;;;;QAQD,gBAAgB,CAAC,IAAmB,EAAE,qBAA8B,EAAE,kBAA2B;YAC/F,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;YACzB,IAAI,qBAAqB;gBAAE,IAAI,CAAC,8BAA8B,GAAG,qBAAqB,CAAA;YACtF,IAAI,kBAAkB;gBAAE,IAAI,CAAC,2BAA2B,GAAG,kBAAkB,CAAA;YAC7E,IAAI,CAAC,YAAY,GAAG,IAAI,CAAA;;YAExB,IAAI,CAAC,aAAa,CAAC,QAAQ,IAAI,IAAI,CAAA;YACnC,IAAI,CAAC,KAAK,GAAG,IAAIS,oBAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC1C,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;YACxD,MAAM,CAAC,iBAAiB,GAAG,IAAI,CAAA;YAC/B,MAAM,CAAC,IAAI,EAAE,CAAA;SACd;;;;;;;;;;QAWD,KAAK,CAAC,QAAiB,EAAE,UAAsB,EAAE,QAAQ,GAAG,CAAC,EAAE,IAAI,GAAG,QAAQ,EAAE,QAAQ,GAAG,IAAI;YAC7F,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE;gBACpB,MAAM,aAAa,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;gBAChD,MAAM,aAAa,GAAG;oBACpB,EAAE,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC;oBAC5B,EAAE,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC;oBAC5B,EAAE,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC;oBAC5B,EAAE,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;oBAC9B,EAAE,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;oBAC9B,EAAE,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;oBAC9B,EAAE,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;oBAC9B,QAAQ,EAAE,CAAC;iBACZ,CAAA;gBACD,MAAM,YAAY,GAAG;oBACnB,EAAE,EAAE,QAAQ,CAAC,CAAC;oBACd,EAAE,EAAE,QAAQ,CAAC,CAAC;oBACd,EAAE,EAAE,QAAQ,CAAC,CAAC;oBACd,EAAE,EAAE,UAAU,CAAC,CAAC;oBAChB,EAAE,EAAE,UAAU,CAAC,CAAC;oBAChB,EAAE,EAAE,UAAU,CAAC,CAAC;oBAChB,EAAE,EAAE,UAAU,CAAC,CAAC;oBAChB,QAAQ,EAAE,CAAC;iBACZ,CAAA;gBACD,MAAM,cAAc,GAAG,IAAIF,gBAAU,EAAE,CAAA;gBACvC,MAAM,eAAe,GAAG,IAAIA,gBAAU,CAAC,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,CAAC,CAAA;gBAC9G,MAAM,OAAO,GAAG;oBACd,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;oBACrB,IAAI,CAAC,aAAa,EAAE,CAAA;oBACpB,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAA0B,CAAC,CAAA;iBACxE,CAAA;gBACD,MAAM,QAAQ,GAAG,CAAC,KAAK;oBACrB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,CAAC,CAAA;oBAC5E,IAAI,QAAQ,EAAE;wBACZ,cAAc,CAAC,gBAAgB,CAAC,eAAe,EAAE,UAAU,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAA;wBACpF,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,cAAc,CAAC,CAAA;qBACpD;yBAAM;wBACL,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,CAAC,CAAA;qBACjG;oBACD,IAAI,CAAC,aAAa,CAAC;wBACjB,IAAI,EAAE,kBAAkB;wBACxB,QAAQ,EAAE,KAAK,CAAC,QAAQ,EAAE;qBACF,CAAC,CAAA;iBAC5B,CAAA;gBACD,MAAM,UAAU,GAAG;oBACjB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;oBACtB,IAAI,CAAC,eAAe,EAAE,CAAA;oBACtB,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,eAAe,EAAwB,CAAC,CAAA;iBACpE,CAAA;gBACDG,wBAAI,CAAC,EAAE,CAAC,aAAa,gCACnB,QAAQ;oBACR,IAAI,IACD,YAAY,KACf,OAAO,EACP,QAAQ,EAAE;wBACR,QAAQ,CAAC,IAAI,CAAC,CAAA;qBACf,EACD,UAAU,IACV,CAAA;aACH;SACF;;;;;;;;QASD,aAAa,CAAC,KAAa,EAAE,QAAQ,GAAG,CAAC,EAAE,IAAI,GAAG,QAAQ;YACxD,IAAI,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE;gBACzC,MAAM,aAAa,GAAG;oBACpB,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI;iBACtB,CAAA;gBACD,MAAM,YAAY,GAAG;oBACnB,IAAI,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC;iBAChD,CAAA;gBACD,MAAM,OAAO,GAAG;oBACd,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;oBACrB,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAA0B,CAAC,CAAA;iBACxE,CAAA;gBACD,MAAM,QAAQ,GAAG,CAAC,KAAK;oBACrB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;oBACtC,IAAI,CAAC,aAAa,CAAC;wBACjB,IAAI,EAAE,kBAAkB;wBACxB,QAAQ,EAAE,KAAK,CAAC,QAAQ,EAAE;qBACF,CAAC,CAAA;iBAC5B,CAAA;gBACD,MAAM,UAAU,GAAG;oBACjB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;oBACtB,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,eAAe,EAAwB,CAAC,CAAA;iBACpE,CAAA;gBACDA,wBAAI,CAAC,EAAE,CAAC,aAAa,gCACnB,QAAQ;oBACR,IAAI,IACD,YAAY,KACf,OAAO,EACP,QAAQ,EAAE;wBACR,QAAQ,CAAC,IAAI,CAAC,CAAA;qBACf,EACD,UAAU,IACV,CAAA;aACH;SACF;;;;QAKD,sBAAsB,CAAC,UAAkB;YACvC,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,CACtB,CAAC,EACD,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,MAAM,CAAC,CACzF,CAAA;gBACD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;aAC5B;SACF;;;;QAKD,gBAAgB,CAAC,IAAY;YAC3B,IAAI,IAAI,CAAC,YAAY;gBAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;SAChD;;;;QAKD,oBAAoB,CAAC,KAAa;YAChC,IAAI,IAAI,CAAC,YAAY;gBAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAA;SACrF;;;UC1hBmB,WAAY,SAAQN,qBAAe;QACvD;YACE,KAAK,EAAE,CAAA;SACR;;;ICiEH,MAAMO,cAAY,GAAkC;QAClD,UAAU,EAAE;YACV,OAAO,EAAE,CAAC,SAAS,EAAE,GAAG,EAAE,GAAG,CAAC;YAC9B,QAAQ,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE,GAAG,CAAC;YACjC,IAAI,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE,GAAG,CAAC;YAC7B,KAAK,EAAE,CAAC,YAAY,EAAE,GAAG,EAAE,GAAG,CAAC;YAC/B,EAAE,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;YACd,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;SACjB;QACD,aAAa,EAAE,GAAG;QAClB,WAAW,EAAE,CAAC;QACd,eAAe,EAAE,IAAI;KACtB,CAAA;IAED;;;;;;;;;;;;;;;;;;;;UAoBa,eAAgB,SAAQ,WAAW;QAS9C,YAAY,KAA2B;YACrC,KAAK,EAAE,CAAA;YACP,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEA,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,MAAM,MAAM,GAAG,EAAE,CAAA;YACjB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,UAAU,EAAE;gBACjC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;aAChB;YACD,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC;gBACvB,MAAM;gBACN,aAAa,EAAE,IAAI,CAAC,aAAa;aAClC,CAAC,CAAA;YACF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACtC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SAC3C;QAED,OAAO;YACL,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;YACtD,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAA;YAC1D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACtB;QAED,UAAU;YACR,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;YACzD,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAA;YAC7D,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;SACvB;QAED,MAAM;YACJ,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;gBAC9D,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAA;gBACpB,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,QAAQ;oBACd,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,EAAE;oBACtC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;iBACH,CAAC,CAAA;gBACpC,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;oBAC/B,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;oBACvB,IAAI,CAAC,aAAa,CAAC;wBACjB,IAAI,EAAE,iBAAiB;qBACC,CAAC,CAAA;iBAC5B;aACF;SACF;QAED,SAAS;YACP,OAAO,IAAI,CAAC,SAAS,CAAA;SACtB;QAEO,OAAO,CAAC,KAAoB;YAClC,IAAI,IAAI,CAAC,IAAI,KAAK,UAAU,EAAE;gBAC5B,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;oBAClC,IAAI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;wBAC7C,IAAI,IAAI,CAAC,eAAe;4BAAE,KAAK,CAAC,cAAc,EAAE,CAAA;wBAChD,IAAI,CAAC,aAAa,CAAC;4BACjB,IAAI,EAAE,SAAS;4BACf,OAAO,EAAE,IAAI;yBACkB,CAAC,CAAA;wBAClC,MAAK;qBACN;iBACF;aACF;SACF;QAEO,SAAS,CAAC,KAAoB;YACpC,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,EAAE;gBAC9B,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;oBAClC,IAAI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;wBAC7C,IAAI,IAAI,CAAC,eAAe;4BAAE,KAAK,CAAC,cAAc,EAAE,CAAA;wBAChD,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;wBAC/C,MAAK;qBACN;iBACF;aACF;SACF;;;IChJH,MAAMA,cAAY,GAAwB;QACxC,UAAU,EAAE,QAAQ,CAAC,IAAI;QACzB,aAAa,EAAE,GAAG;QAClB,eAAe,EAAE,IAAI;QACrB,mBAAmB,EAAE,IAAI;QACzB,qBAAqB,EAAE,GAAG;KAC3B,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UA+Ba,cAAe,SAAQ,WAAW;QAgB7C,YAAY,KAA0B;YACpC,KAAK,EAAE,CAAA;YAhBD,eAAU,GAAG,QAAQ,CAAC,IAAI,CAAA;YAE1B,oBAAe,GAAG,IAAI,CAAA;YACtB,wBAAmB,GAAG,IAAI,CAAA;YAM1B,iBAAY,GAAG,CAAC,CAAA;YAChB,qBAAgB,GAAG,KAAK,CAAA;YACxB,UAAK,GAAwB,EAAE,CAAA;YAC/B,iBAAY,GAAG,CAAC,CAAA;YAChB,eAAU,GAAG,CAAC,CAAA;YAIpB,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEA,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC;gBACvB,MAAM,EAAE,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;gBAC5B,aAAa,EAAE,IAAI,CAAC,aAAa;aAClC,CAAC,CAAA;YACF,IAAI,CAAC,aAAa,EAAE,CAAA;YACpB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAClD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC9C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAClD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SACzC;QAED,OAAO;YACL,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YACtF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YACtF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,cAAc,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YACrF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YAClF,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;YAChD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACtB;QAED,UAAU;YACR,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACtE,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACtE,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,cAAc,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YACrE,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YAClE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;SACvB;QAED,MAAM,CAAC,IAAY;YACjB,IACE,IAAI,CAAC,YAAY,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM;gBACvC,IAAI,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,qBAAqB;gBACrD,IAAI,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,qBAAqB,EACnD;gBACA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAA;gBACrC,IAAI,IAAI,CAAC,YAAY,KAAK,CAAC,EAAE;oBAC3B,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;oBAC1B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAA;iBAC9B;qBAAM;oBACL,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAA;oBAC7D,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAA;iBAC7B;aACF;YAED,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;gBAChC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAA;gBACpB,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,QAAQ;oBACd,MAAM,EAAE,IAAI,CAAC,eAAe;0BACxB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,gBAAgB,EAAiB,EAAE,IAAI,CAAC,mBAAmB,CAAC;0BACvF,IAAI,CAAC,MAAM,CAAC,gBAAgB,EAAE;oBAClC,MAAM,EAAE,IAAI,CAAC,eAAe;0BACxB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,EAAiB,EAAE,KAAK,CAAC;0BAClE,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;oBAChC,YAAY,EAAE,IAAI,CAAC,YAAY;iBACT,CAAC,CAAA;gBACzB,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;oBAC/B,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAA2B,CAAC,CAAA;iBACzE;aACF;SACF;QAED,SAAS;YACP,OAAO,IAAI,CAAC,SAAS,CAAA;SACtB;QAEO,aAAa;YACnB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE,CAAC,KAAK,CAAA;YAC1D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE,CAAC,MAAM,CAAA;SAC7D;QAEO,kBAAkB,CAAC,KAAmB;;YAE5C,OAAO;gBACL,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;gBAC1E,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;aAC3E,CAAA;SACF;QAEO,SAAS,CAAC,MAAmB,EAAE,UAAmB;YACxD,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAA;YAC7B,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAA;YAC9B,IAAI,UAAU,EAAE;gBACd,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;gBACb,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;aACd;YACD,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAA;SAChB;QAEO,aAAa,CAAC,KAAmB;YACvC,IAAI,IAAI,CAAC,YAAY,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;gBAC3C,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;oBAC3B,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;wBAC1B,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAA;wBACrD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAA;qBAC7B;yBAAM;wBACL,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAA;qBACtD;iBACF;qBAAM;oBACL,IAAI,KAAK,CAAC,SAAS,KAAK,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE;wBAC/C,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAA;qBACtD;iBACF;aACF;SACF;QAEO,aAAa,CAAC,KAAmB;;;YAGvC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;gBACtB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;gBACtB,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,CAAA;aAC7C;SACF;QAEO,WAAW,CAAC,KAAmB;YACrC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,KAAK,cAAc,EAAE;gBACvD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBAC1C,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,EAAE;wBAC9C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;wBACvB,MAAK;qBACN;iBACF;gBACD,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,CAAA;aAC3C;SACF;QAEO,QAAQ;YACd,IAAI,CAAC,aAAa,EAAE,CAAA;SACrB;;;IC1MH,MAAMA,cAAY,GAAgC;QAChD,WAAW,EAAE,KAAK;QAClB,SAAS,EAAE,KAAK;QAChB,MAAM,EAAE,GAAG;QACX,aAAa,EAAE,GAAG;KACnB,CAAA;IAED;;;;;;;;;;;;;;UAca,aAAc,SAAQ,WAAW;QAkB5C,YAAY,KAAyB;YACnC,KAAK,EAAE,CAAA;YACP,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEA,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,CAAC,mBAAmB,GAAG,MAAM,CAAC,OAAO,IAAI,CAAC,CAAC,CAAA;YAC/C,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAA;YACnD,IAAI,CAAC,MAAM,GAAG;gBACZ,QAAQ,EAAE,IAAI;gBACd,aAAa,EAAE,IAAI;aACpB,CAAA;YACD,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC;gBACvB,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,aAAa,EAAE,IAAI,CAAC,aAAa;aAClC,CAAC,CAAA;YACF,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC9D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACxC,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA;YAClE,IAAI,CAAC,mBAAmB,EAAE,CAAA;SAC3B;QAED,OAAO;YACL,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YACnE,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;YAC1C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACtB;QAED,UAAU;YACR,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;YACnD,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;YAC5C,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;SACvB;QAED,MAAM;YACJ,IACE,IAAI,CAAC,mBAAmB,KAAK,IAAI,CAAC,mBAAmB;gBACrD,IAAI,CAAC,mBAAmB,IAAI,IAAI,CAAC,qBAAqB;gBACtD,IAAI,CAAC,mBAAmB,IAAI,IAAI,CAAC,mBAAmB,EACpD;gBACA,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAA;gBACpG,MAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;gBACxE,IAAI,CAAC,MAAM,GAAG;oBACZ,QAAQ;oBACR,aAAa;iBACd,CAAA;gBACD,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;gBAClC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAA;aACpD;YACD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;gBAChC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAA;gBACpB,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,QAAQ;oBACd,MAAM,EAAE,IAAI,CAAC,MAAM;oBACnB,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,EAAE;iBACzB,CAAC,CAAA;gBACxB,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;oBAC/B,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAA2B,CAAC,CAAA;iBACzE;aACF;SACF;QAED,SAAS;YACP,OAAO,IAAI,CAAC,SAAS,CAAA;SACtB;QAED,WAAW,CAAC,MAAc;YACxB,IAAI,MAAM,GAAG,CAAC,CAAA;YACd,IAAI,MAAM,EAAE;gBACV,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAA;gBACzB,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;oBAC/B,MAAM,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC,WAAW,IAAI,GAAG,CAAA;iBAC7C;qBAAM,IAAI,IAAI,CAAC,QAAQ,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;oBACtD,MAAM,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,IAAI,GAAG,CAAA;iBACxC;aACF;YACD,OAAO,MAAM,CAAA;SACd;QAEO,eAAe,CAAC,OAAoB;YAC1C,IAAI,CAAC,OAAO;gBAAE,OAAO,CAAC,CAAA;YACtB,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,YAA2B,CAAC,GAAG,OAAO,CAAC,SAAS,CAAA;SACrF;QAEO,mBAAmB;YACzB,MAAM,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAA;YACrD,MAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;YAC1D,IAAI,CAAC,aAAa,GAAG,SAAS,GAAG,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;YACxF,IAAI,CAAC,WAAW,GAAG,SAAS,GAAG,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;YAC/E,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAA;YACrD,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAA;YAChF,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,GAAG,CACjC,IAAI,CAAC,WAAW,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,EACpC,QAAQ,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,MAAM,CAC7C,CAAA;SACF;QAEO,QAAQ;YACd,IAAI,CAAC,mBAAmB,GAAG,MAAM,CAAC,OAAO,CAAA;SAC1C;;;ICzIH,MAAMA,cAAY,GAAsB;QACtC,UAAU,EAAE,QAAQ,CAAC,IAAI;QACzB,UAAU,EAAE,EAAE;QACd,UAAU,EAAE,EAAE;KACf,CAAA;IAED;;;;;;;;;;;;;;;UAea,YAAa,SAAQ,WAAW;QAQ3C,YAAY,QAA2B,EAAE;YACvC,KAAK,EAAE,CAAA;YACP,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEA,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC9C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SACnD;QAED,OAAO;YACL,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YACtF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YAClF,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACtB;QAED,UAAU;YACR,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACtE,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YAClE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;SACvB;QAED,MAAM;;SAEL;QAED,SAAS;YACP,OAAO,IAAI,CAAC,SAAS,CAAA;SACtB;QAEO,aAAa,CAAC,KAAmB;YACvC,IAAI,KAAK,CAAC,WAAW,KAAK,OAAO,IAAI,KAAK,CAAC,SAAS,EAAE;gBACpD,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,OAAO,CAAA;gBAC3B,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,OAAO,CAAA;aAC5B;SACF;QAEO,WAAW,CAAC,KAAmB;YACrC,IAAI,KAAK,CAAC,WAAW,KAAK,OAAO,IAAI,KAAK,CAAC,SAAS,EAAE;gBACpD,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAA;gBACzC,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAA;gBACzC,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,EAAE;oBAC5E,IAAI,CAAC,aAAa,CAAC;wBACjB,IAAI,EAAE,SAAS;wBACf,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;wBAC5D,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC;qBAC7C,CAAC,CAAA;iBACxB;aACF;SACF;;;ICrDH,MAAMA,cAAY,GAA+B;QAC/C,aAAa,EAAE,GAAG;QAClB,UAAU,EAAE,EAAE;QACd,UAAU,EAAE,EAAE;QACd,gBAAgB,EAAE,GAAG;KACtB,CAAA;IAED;;;;;;;;;;;;;;UAca,YAAa,SAAQ,WAAW;QAW3C,YAAY,KAAwB;YAClC,KAAK,EAAE,CAAA;YAJD,yBAAoB,GAAG,CAAC,CAAA;YAK9B,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEA,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC;gBACvB,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;gBACtB,aAAa,EAAE,IAAI,CAAC,aAAa;aAClC,CAAC,CAAA;YACF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SACvC;QAED,OAAO;YACL,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,IAAI,MAAM,CAAA;YACzC,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YAClE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACtB;QAED,UAAU;YACR,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,IAAI,MAAM,CAAA;YACzC,OAAO,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;YAClD,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;SACvB;QAED,MAAM;YACJ,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;gBAC9D,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAA;gBACpB,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,QAAQ;oBACd,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,EAAE;oBACtC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;iBACN,CAAC,CAAA;gBACjC,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;oBAC/B,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;oBACvB,IAAI,CAAC,aAAa,CAAC;wBACjB,IAAI,EAAE,iBAAiB;qBACC,CAAC,CAAA;iBAC5B;aACF;SACF;QAED,SAAS;YACP,OAAO,IAAI,CAAC,SAAS,CAAA;SACtB;QAEO,OAAO,CAAC,KAAiB;YAC/B,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,EAAE;gBAC9B,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,KAAK,CAAC,MAAM,CAAC,CAAA;gBAC1C,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,KAAK,CAAC,MAAM,CAAC,CAAA;aAC3C;iBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,UAAU,EAAE;gBACnC,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,UAAU,EAAE;oBAC1F,MAAM,GAAG,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,CAAA;oBACpC,IAAI,GAAG,GAAG,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,EAAE;wBAC3D,IAAI,CAAC,oBAAoB,GAAG,GAAG,CAAA;wBAC/B,IAAI,CAAC,aAAa,CAAC;4BACjB,IAAI,EAAE,SAAS;4BACf,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC;4BAC1E,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC;yBAC9C,CAAC,CAAA;qBAChC;iBACF;aACF;SACF;;;IC9GH,MAAMA,cAAY,GAA8B;QAC9C,UAAU,EAAE,QAAQ,CAAC,IAAI;QACzB,iBAAiB,EAAE,GAAG;QACtB,kBAAkB,EAAE,CAAC;QACrB,kBAAkB,EAAE,GAAG;QACvB,mBAAmB,EAAE,GAAG;QACxB,eAAe,EAAE,IAAI;QACrB,gBAAgB,EAAE,IAAI;QACtB,eAAe,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC;QAC5B,gBAAgB,EAAE,IAAI,CAAC,EAAE,GAAG,EAAE;KAC/B,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UA6Ba,oBAAoB;;QAY/B,YAAY,SAAoB,EAAE,QAAmC,EAAE;YAH/D,YAAO,GAAG,KAAK,CAAA;YAIrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;YAE1B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,gBAAgB,IAAIA,cAAY,CAAC,gBAAgB,CAAA;YAC/E,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC,kBAAkB,IAAIA,cAAY,CAAC,kBAAkB,CAAA;YACrF,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC,eAAe,IAAIA,cAAY,CAAC,eAAe,CAAA;YAC5E,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,gBAAgB,IAAIA,cAAY,CAAC,gBAAgB,CAAA;YAE/E,IAAI,CAAC,eAAe,GAAG,IAAI,eAAe,CAAC;gBACzC,IAAI,EAAE,YAAY;gBAClB,aAAa,EAAE,KAAK,CAAC,kBAAkB,IAAIA,cAAY,CAAC,kBAAkB;gBAC1E,WAAW,EAAE,KAAK,CAAC,mBAAmB,IAAIA,cAAY,CAAC,mBAAmB;aAC3E,CAAC,CAAA;YAEF,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,CAAC;gBACnC,IAAI,EAAE,YAAY;gBAClB,aAAa,EAAE,KAAK,CAAC,eAAe,IAAIA,cAAY,CAAC,eAAe;gBACpE,UAAU,EAAE,KAAK,CAAC,UAAU,IAAIA,cAAY,CAAC,UAAU;aACxD,CAAC,CAAA;YAEF,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC;gBACvC,UAAU,EAAE,KAAK,CAAC,UAAU,IAAIA,cAAY,CAAC,UAAU;gBACvD,aAAa,EAAE,KAAK,CAAC,iBAAiB,IAAIA,cAAY,CAAC,iBAAiB;aACzE,CAAC,CAAA;YAEF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACtC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAClC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SAC3C;QAED,SAAS;YACP,OAAO,IAAI,CAAC,OAAO,CAAA;SACpB;QAED,MAAM;YACJ,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAA;YAC3B,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAA;YAC9B,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAA;YAC7B,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;YAC1D,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;YAC3D,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAA;YAC9D,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;SACpB;QAED,OAAO;YACL,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAA;YAC9B,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,CAAA;YACjC,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,CAAA;YAChC,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;YAC7D,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;YAC9D,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAA;YACjE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;SACrB;QAEO,OAAO,CAAC,KAAK;YACnB,IAAI,CAAC,SAAS,CAAC,EAAE,CAACX,oBAAY,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAA;YAC7E,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAA;SAC9E;QAEO,KAAK,CAAC,KAAK;YACjB,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;YACnF,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;YAC7E,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;SAC9E;QAEO,SAAS,CAAC,KAAK;YACrB,QAAQ,KAAK,CAAC,YAAY;gBACxB,KAAK,CAAC;oBACJ,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,GAAG,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,CAAA;oBAC1E,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAA;oBAC5E,MAAK;gBACP,KAAK,CAAC;oBACJ,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,kBAAkB,CAAC,CAAA;oBAChF,IAAI,CAAC,SAAS,CAAC,EAAE,CAACA,oBAAY,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,kBAAkB,CAAC,CAAA;oBAChF,MAAK;aAGR;SACF;QAED,MAAM,CAAC,IAAY;YACjB,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAA;gBAC7B,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAA;gBAC1B,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;aACjC;SACF;;;IC1HH,MAAMW,cAAY,GAAiC;QACjD,WAAW,EAAE,KAAK;QAClB,SAAS,EAAE,KAAK;QAChB,aAAa,EAAE,CAAC;QAChB,MAAM,EAAE,GAAG;QACX,WAAW,EAAE,IAAI;QACjB,SAAS,EAAE,MAAM;QACjB,aAAa,EAAE,EAAE;KAClB,CAAA;IAED,MAAM,QAAQ,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM;QACpD,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,MAAM,GAAG,KAAK,KAAK,CAAC,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,KAAK,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAA;IAC9G,CAAC,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UA6Ca,cAAc;QAazB,YAAY,SAAoB,EAAE,KAA0B;YAVpD,YAAO,GAAG,KAAK,CAAA;YAWrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;YAC1B,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAA;YAElC,IAAI,CAAC,aAAa,GAAG,IAAI,aAAa,CAAC;gBACrC,aAAa,EAAE,KAAK,CAAC,aAAa;gBAClC,aAAa,EAAE,KAAK,CAAC,aAAa,IAAIA,cAAY,CAAC,aAAa;gBAChE,WAAW,EAAE,KAAK,CAAC,WAAW,IAAIA,cAAY,CAAC,WAAW;gBAC1D,SAAS,EAAE,KAAK,CAAC,SAAS,IAAIA,cAAY,CAAC,SAAS;gBACpD,MAAM,EAAE,KAAK,CAAC,MAAM,IAAIA,cAAY,CAAC,MAAM;aAC5C,CAAC,CAAA;YAEF,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,IAAIA,cAAY,CAAC,WAAW,CAAA;YAChE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,SAAS,IAAIA,cAAY,CAAC,SAAS,CAAA;YAC1D,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC,aAAa,IAAIA,cAAY,CAAC,aAAa,CAAA;YACtE,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,IAAIA,cAAY,CAAC,MAAM,CAAA;YACjD,IAAI,CAAC,cAAc,EAAE,CAAA;YACrB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SACzC;QAED,SAAS;YACP,OAAO,IAAI,CAAC,OAAO,CAAA;SACpB;QAED,MAAM;YACJ,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAA;YAC5B,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;YAC5D,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;SACpB;QAED,OAAO;YACL,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,CAAA;YAC/B,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;YAC/D,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;SACrB;QAED,MAAM;YACJ,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAA;aAC5B;SACF;QAEO,cAAc;YACpB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;YACrE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;YACjE,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,aAAa,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAA;YACnE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,WAAW,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAA;YAC/D,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,MAAM;gBAChC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;gBAC7D,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;gBACzD,MAAM,CAAC,eAAe,GAAG,MAAM,CAAC,OAAO,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAA;gBAC3D,MAAM,CAAC,aAAa,GAAG,MAAM,CAAC,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAA;aACxD,CAAC,CAAA;SACH;QAEO,QAAQ,CAAC,KAAK;YACpB,MAAM,QAAQ,GAAG,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAA;YAC9C,IAAI,QAAQ,IAAI,IAAI,CAAC,qBAAqB,IAAI,QAAQ,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBAClF,IAAI,CAAC,SAAS,CAAC,sBAAsB,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;aACtG;YACD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,MAAM;gBAChC,IAAI,QAAQ,IAAI,MAAM,CAAC,eAAe,IAAI,QAAQ,IAAI,MAAM,CAAC,aAAa,EAAE;oBAC1E,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;iBACxE;aACF,CAAC,CAAA;SACH;;;IC3JH,MAAMA,cAAY,GAA6B;QAC7C,KAAK,EAAE,KAAK;QACZ,WAAW,EAAE,IAAI;KAClB,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UA6Ba,mBAAoB,SAAQP,qBAAe;QAUtD,YAAY,SAAoB,EAAE,OAA2B,EAAE,EAAE,QAAkC,EAAE;YACnG,KAAK,EAAE,CAAA;YAPD,iBAAY,GAAkB,IAAI,CAAA;YAClC,kBAAa,GAAkB,IAAI,CAAA;YACnC,YAAO,GAAG,KAAK,CAAA;YAMrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;YAC1B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;YAChB,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEO,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,eAAe,GAAG,IAAI,eAAe,CAAC;oBACzC,IAAI,EAAE,UAAU;oBAChB,UAAU,EAAE;wBACV,IAAI,EAAE,CAAC,WAAW,EAAE,YAAY,CAAC;wBACjC,IAAI,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC;qBAC/B;iBACF,CAAC,CAAA;gBACF,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;aACnC;YACD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAClD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACpD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SAC/C;QAED,eAAe;YACb,OAAO,IAAI,CAAC,YAAY,CAAA;SACzB;QAED,OAAO;YACL,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,GAAG,CAAC,CAAA;YAClC,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAC3C,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,UAAU;oBAChB,QAAQ,EAAE,KAAK;iBACC,CAAC,CAAA;aACpB;iBAAM;gBACL,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;aACtC;SACF;QAED,OAAO;YACL,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,GAAG,CAAC,CAAA;YAClC,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAC3B,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,UAAU;oBAChB,QAAQ,EAAE,OAAO;iBACD,CAAC,CAAA;aACpB;iBAAM;gBACL,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;aAC3D;SACF;QAED,OAAO,CAAC,KAAa;YACnB,IAAI,CAAC,aAAa,GAAG,KAAK,CAAA;YAC1B,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;YACzC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAA;SACzF;QAED,MAAM;YACJ,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAA;gBAC9B,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;aAC7D;YACD,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACtE,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAA;YACxE,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YAClE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;SACpB;QAED,OAAO;YACL,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,CAAA;gBACjC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;aAChE;YACD,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACzE,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAA;YAC3E,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YACrE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;SACrB;QAED,MAAM;;SAEL;QAED,SAAS;YACP,OAAO,IAAI,CAAC,OAAO,CAAA;SACpB;QAEO,UAAU,CAAC,QAAgB;YACjC,IAAI,CAAC,aAAa,CAAC;gBACjB,IAAI,EAAE,QAAQ;gBACd,YAAY,EAAE,IAAI,CAAC,YAAY;gBAC/B,aAAa,EAAE,IAAI,CAAC,aAAa;gBACjC,QAAQ;aACU,CAAC,CAAA;SACtB;QAEO,aAAa;YACnB,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;SACnB;QAEO,cAAc,CAAC,KAAK;YAC1B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAA;SAChC;QAEO,WAAW;YACjB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAA;YACtC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;SAC1B;QAEO,KAAK,CAAC,KAAK;YACjB,IAAI,KAAK,CAAC,OAAO,KAAK,MAAM,EAAE;gBAC5B,IAAI,CAAC,OAAO,EAAE,CAAA;aACf;iBAAM,IAAI,KAAK,CAAC,OAAO,KAAK,MAAM,EAAE;gBACnC,IAAI,CAAC,OAAO,EAAE,CAAA;aACf;SACF;;;IC7JH,MAAMA,cAAY,GAA4B;QAC5C,cAAc,EAAE,EAAE;QAClB,cAAc,EAAE,EAAE;QAClB,QAAQ,EAAE,CAAC;QACX,IAAI,EAAE,QAAQ;QACd,WAAW,EAAE,IAAI;KAClB,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UA0Ca,kBAAmB,SAAQP,qBAAe;QAerD,YAAY,SAAoB,EAAE,OAA0B,EAAE,EAAE,QAAiC,EAAE;YACjG,KAAK,EAAE,CAAA;YAVD,iBAAY,GAAG,CAAC,CAAA;YAChB,kBAAa,GAAkB,IAAI,CAAA;YACnC,YAAO,GAAG,KAAK,CAAA;YASrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;YAC1B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;YAChB,MAAM,CAAC,MAAM,CAAC,IAAI,EAAEO,cAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,CAAC,EAAE,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAA;YAC3F,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,CAAC,EAAE,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAA;YACzE,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,eAAe,GAAG,IAAI,eAAe,CAAC;oBACzC,IAAI,EAAE,UAAU;oBAChB,UAAU,EAAE;wBACV,IAAI,EAAE,CAAC,WAAW,EAAE,YAAY,CAAC;wBACjC,IAAI,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC;qBAC/B;iBACF,CAAC,CAAA;gBACF,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;aACnC;YACD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAClD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACpD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC9C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SAC3C;QAED,eAAe;YACb,OAAO,IAAI,CAAC,YAAY,CAAA;SACzB;QAED,MAAM;YACJ,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;gBAC5D,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAA;aAC/B;YACD,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAA;YAC7D,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAA;YAC7D,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACtE,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAA;YACxE,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YAClE,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAA;YAC3B,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAA;YAC3B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;SACpB;QAED,OAAO;YACL,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;gBAC/D,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,CAAA;aAClC;YACD,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAA;YAChE,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAA;YAChE,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,iBAAiB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACzE,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAA;YAC3E,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;YACrE,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAA;YAC9B,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAA;YAC9B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;SACrB;QAED,MAAM;;SAEL;QAED,SAAS;YACP,OAAO,IAAI,CAAC,OAAO,CAAA;SACpB;QAEO,KAAK,CAAC,KAAK;YACjB,QAAQ,KAAK,CAAC,OAAO;gBACnB,KAAK,MAAM;oBACT,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAA;oBACzB,MAAK;gBACP,KAAK,MAAM;oBACT,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAA;oBACxB,MAAK;aAGR;SACF;QAEO,SAAS,CAAC,KAAK;YACrB,MAAM,KAAK,GAAG,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,CAAC,CAAA;YACzC,IAAI,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAC7B,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,UAAU;oBAChB,QAAQ,EAAE,KAAK;iBACC,CAAC,CAAA;aACpB;iBAAM,IAAI,KAAK,GAAG,CAAC,EAAE;gBACpB,IAAI,CAAC,aAAa,CAAC;oBACjB,IAAI,EAAE,UAAU;oBAChB,QAAQ,EAAE,OAAO;iBACD,CAAC,CAAA;aACpB;iBAAM;gBACL,IAAI,CAAC,aAAa,GAAG,KAAK,CAAA;gBAC1B,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;aAC5F;SACF;QAEO,UAAU,CAAC,QAAgB;YACjC,IAAI,CAAC,aAAa,CAAC;gBACjB,IAAI,EAAE,QAAQ;gBACd,YAAY,EAAE,IAAI,CAAC,YAAY;gBAC/B,aAAa,EAAE,IAAI,CAAC,aAAa;gBACjC,QAAQ;aACU,CAAC,CAAA;SACtB;QAEO,aAAa;YACnB,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;SACnB;QAEO,cAAc,CAAC,KAAK;YAC1B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAA;SAChC;QAEO,WAAW;YACjB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAA;YACtC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;SAC1B;;;ICzLH,MAAM,YAAY,GAA0B;QAC1C,UAAU,EAAE,QAAQ,CAAC,IAAI;QACzB,SAAS,EAAE,IAAI,CAAC,EAAE,GAAG,EAAE;QACvB,UAAU,EAAE,IAAI,CAAC,EAAE,GAAG,EAAE;QACxB,WAAW,EAAE,CAAC;QACd,cAAc,EAAE,CAAC;QACjB,aAAa,EAAE,GAAG;KACnB,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;UA0Ba,gBAAgB;QAS3B,YAAY,SAAoB,EAAE,QAA+B,EAAE;YAN3D,YAAO,GAAG,KAAK,CAAA;YAOrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;YAC1B,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,YAAY,EAAE,KAAK,CAAC,CAAA;YACxC,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC;gBACvC,UAAU,EAAE,KAAK,CAAC,UAAU,IAAI,YAAY,CAAC,UAAU;gBACvD,aAAa,EAAE,KAAK,CAAC,aAAa,IAAI,YAAY,CAAC,aAAa;aACjE,CAAC,CAAA;YACF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SACnD;QAED,SAAS;YACP,OAAO,IAAI,CAAC,OAAO,CAAA;SACpB;QAED,MAAM;YACJ,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAA;YAC7B,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YAClE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;SACpB;QAED,OAAO;YACL,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,CAAA;YAChC,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;YACrE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;SACrB;QAED,MAAM,CAAC,IAAY;YACjB,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;aACjC;SACF;QAEO,aAAa,CAAC,KAAK;YACzB,IAAI,KAAK,CAAC,YAAY,KAAK,CAAC,EAAE;gBAC5B,IAAI,CAAC,SAAS,CAAC,EAAE,CAACX,oBAAY,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,SAAS,EAAEC,oBAAY,CAAC,IAAI,CAAC,CAAA;gBACxF,IAAI,CAAC,SAAS,CAAC,EAAE,CAACD,oBAAY,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,EAAEC,oBAAY,CAAC,IAAI,CAAC,CAAA;gBAC1F,IAAI,CAAC,SAAS,CAAC,EAAE,CAACD,oBAAY,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,WAAW,EAAEC,oBAAY,CAAC,IAAI,CAAC,CAAA;gBAC3F,IAAI,CAAC,SAAS,CAAC,EAAE,CAACD,oBAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,cAAc,EAAEC,oBAAY,CAAC,IAAI,CAAC,CAAA;aAClG;SACF;;;IC1GH,SAAS,WAAW,CAAC,GAAG,EAAE,GAAG,EAAE;IAC/B,EAAE,KAAK,GAAG,KAAK,KAAK,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;IACjC,EAAE,IAAI,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;AAC9B;IACA,EAAE,IAAI,CAAC,GAAG,IAAI,OAAO,QAAQ,KAAK,WAAW,EAAE,EAAE,OAAO,EAAE;AAC1D;IACA,EAAE,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IACvE,EAAE,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;IAC9C,EAAE,KAAK,CAAC,IAAI,GAAG,UAAU,CAAC;AAC1B;IACA,EAAE,IAAI,QAAQ,KAAK,KAAK,EAAE;IAC1B,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;IACzB,MAAM,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;IAChD,KAAK,MAAM;IACX,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;IAC9B,KAAK;IACL,GAAG,MAAM;IACT,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;IAC5B,GAAG;AACH;IACA,EAAE,IAAI,KAAK,CAAC,UAAU,EAAE;IACxB,IAAI,KAAK,CAAC,UAAU,CAAC,OAAO,GAAG,GAAG,CAAC;IACnC,GAAG,MAAM;IACT,IAAI,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC;IACpD,GAAG;IACH;;;;;ICnBA,MAAM,aAAa,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,CAAA;IAU9F,MAAM,QAAQ,GAAG;QACf,KAAK,EAAE,OAAO;QACd,MAAM,EAAE,QAAQ;QAChB,QAAQ,EAAE,UAAU;QACpB,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,SAAS;QACjB,QAAQ,EAAE,WAAW;KACtB,CAAA;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAsGa,YAAY;QAiBvB,YAAY,GAAc,EAAE,QAA8B,EAAE,MAAyB,EAAE,YAA0B;YAFzG,aAAQ,GAAG,IAAI,CAAA;YAGrB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAA;YACd,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;YACxB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;YACpB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAA;YACd,IAAI,CAAC,YAAY,GAAG,IAAI,CAAA;YACxB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;YACtB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;YACtB,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAA;SAC1B;QAEO,OAAO;YACb,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACtB;QAED,MAAM,CAAC,IAAY;YACjB,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBAC/C,MAAM,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAA;gBACnC,MAAM,CAAC,KAAK,GAAG,GAAG,CAAA;gBAClB,MAAM,CAAC,MAAM,GAAG,GAAG,CAAA;gBACnB,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAA;gBAC7D,MAAM,KAAK,GAAG,MAAM,CAAC,SAAS,EAAE,CAAA;gBAEhC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;gBAClB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;aACvB;YACD,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;oBACvB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;oBACzB,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAA;oBACvB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAA;iBACzB;gBACD,MAAM,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,CAAA;gBAC5C,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAA;gBAC5B,IAAI,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE;oBACnC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;oBACtB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;oBACzB,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAA;oBACtB,IAAI,CAAC,GAAG,CAAC,eAAe,EAAE,CAAA;iBAC3B;aACF;SACF;QAEO,MAAM,CAAC,KAAa;YAC1B,IAAI,CAAC,IAAI,CAAC,IAAI,iCACT,IAAI,CAAC,GAAG,CAAC,mBAAmB,EAAE,KACjC,QAAQ,EAAE,CAAC,EACX,IAAI,EAAE,QAAQ,EACd,KAAK,IACL,CAAA;YACF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAA;YACxC,IAAI,CAAC,UAAU,EAAE,CAAA;YACjB,IAAI,CAAC,MAAM,EAAE,CAAA;SACd;QAEO,SAAS,CAAC,KAAa,EAAE,KAAmB;YAClD,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,mCACX,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAChB,KAAK,CACT,CAAA;SACF;QAEO,OAAO,CAAC,KAAa,EAAE,SAAiB;YAC9C,IAAI,KAAK,GAAG,SAAS,IAAI,CAAC,IAAI,KAAK,GAAG,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAClE,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;gBAC7B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,CAAA;gBAC/C,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,GAAG,IAAI,CAAA;gBACnC,IAAI,CAAC,MAAM,EAAE,CAAA;aACd;SACF;QAEO,SAAS,CAAC,KAAa;YAC7B,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;YAC1B,IAAI,CAAC,MAAM,EAAE,CAAA;SACd;QAEO,OAAO,CAAC,KAAa;YAC3B,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;YAC5B,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;SACpF;QAEO,UAAU;YAChB,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxB,MAAM,KAAK,GAAG,EAAE,CAAA;gBAChB,MAAM,cAAc,GAAG,EAAE,CAAA;gBACzB,MAAM,gBAAgB,GAAG,EAAE,CAAA;gBAC3B,MAAM,WAAW,GAAG,IAAIE,aAAO,EAAE,CAAA;gBACjC,MAAM,aAAa,GAAG,IAAII,gBAAU,EAAE,CAAA;gBACtC,MAAM,YAAY,GAAG,EAAE,CAAA;gBAEvB,IAAI,cAAc,GAAG,CAAC,CAAA;;gBAGtB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,SAAS,EAAE;oBAC7E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;wBACzC,MAAM,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;wBACtB,CAAC,CAAC,UAAU,GAAG,IAAIA,gBAAU,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAA;wBACjG,CAAC,CAAC,QAAQ,GAAG,IAAIJ,aAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA;qBACtE;iBACF;gBAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;oBAC7C,MAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;oBACvB,MAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAA;oBAE3B,MAAM,MAAM,GAAG;wBACb,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;wBACjB,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;wBACjB,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;wBACjB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,WAAW,EAAE,CAAC;qBACf,CAAA;oBAED,MAAM,MAAM,GAAG;wBACb,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;wBACjB,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;wBACjB,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;wBACjB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;wBACnB,WAAW,EAAE,CAAC;wBACd,QAAQ,EAAE,EAAE,CAAC,QAAQ;wBACrB,IAAI,EAAE,EAAE,CAAC,IAAI;qBACd,CAAA;oBAED,MAAM,KAAK,GAAGO,wBAAI,CAAC,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAA;oBAErC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,EAAE,CAAC,EAAE,EAAE;wBACrC,MAAM,UAAU,GAAG,EAAE,CAAC,QAAQ,IAAI,CAAC,GAAG,YAAY,CAAC,CAAA;wBACnD,KAAK,CAAC,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC,CAAA;wBACvC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;wBACtB,IAAI,IAAI,CAAC,QAAQ,EAAE;4BACjB,aAAa,CAAC,gBAAgB,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,EAAE,MAAM,CAAC,WAAW,CAAC,CAAA;yBACjF;6BAAM;4BACL,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,CAAA;yBAC9D;wBACD,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,CAAA;wBAChD,aAAa,CAAC,OAAO,CAAC,gBAAgB,EAAE,gBAAgB,CAAC,MAAM,CAAC,CAAA;wBAChE,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,cAAc,CAAC,MAAM,CAAC,CAAA;qBAC3D;oBACD,cAAc,IAAI,EAAE,CAAC,QAAQ,CAAA;iBAC9B;;gBAED,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA;gBAC5C,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,gBAAgB,EAAE,gBAAgB,CAAC,MAAM,CAAC,CAAA;gBAClE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,cAAc,EAAE,cAAc,CAAC,MAAM,CAAC,CAAA;gBAC5D,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;gBAC1B,IAAI,CAAC,aAAa,GAAG,IAAIE,mBAAa,CAAC,IAAI,EAAE,cAAc,EAAE;oBAC3D,IAAIC,yBAAmB,CAAC,sBAAsB,EAAE,KAAK,EAAE,cAAc,CAAC;oBACtE,IAAIC,6BAAuB,CAAC,qBAAqB,EAAE,KAAK,EAAE,gBAAgB,CAAC;iBAC5E,CAAC,CAAA;gBACF,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;aAC9C;SACF;QAEO,SAAS,CAAC,MAAc;YAC9B,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxB,IAAI,CAAC,GAAG,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAA;aACxC;SACF;QAEO,QAAQ;YACd,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;aACtB;SACF;QAEO,MAAM;YACZ,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAA;gBACtB,MAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAA;gBAE/B,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG;oBACxB,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAA;oBAC1C,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;wBAChB,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAS,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;wBAClD,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAA;wBACvB,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC,aAAa,CAAA;wBACzC,IAAI,CAAC,UAAU,EAAE,CAAA;wBACjB,IAAI,CAAC,MAAM,EAAE,CAAA;qBACd,CAAA;iBACF,CAAA;aACF;SACF;QAEO,MAAM,CAAC,EAAE,KAAK,EAAE;YACtB,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxB,MAAM,QAAQ,GAAG,EAAS,CAAA;gBAC1B,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG;oBAChC,MAAM,QAAQ,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;oBACjE,MAAM,UAAU,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,EAAE,GAAG,CAAC,UAAU,CAAC,CAAC,EAAE,GAAG,CAAC,UAAU,CAAC,CAAC,EAAE,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;oBAC3F,MAAM,GAAG,GAAG;wBACV,QAAQ;wBACR,UAAU;wBACV,QAAQ,EAAE,GAAG,CAAC,QAAQ;wBACtB,IAAI,EAAE,GAAG,CAAC,IAAI;qBACR,CAAA;oBAER,IAAI,KAAK,EAAE;wBACT,GAAG,CAAC,KAAK,GAAG,GAAG,CAAC,KAAK,CAAA;qBACtB;oBAED,OAAO,GAAG,CAAA;iBACX,CAAC,CAAA;gBACF,IAAI,IAAI,CAAC,aAAa,EAAE;oBACtB,QAAQ,CAAC,aAAa,GAAGF,mBAAa,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;iBAClE;gBACD,MAAM,IAAI,GAAG,0BAA0B,GAAG,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAA;gBACtF,MAAM,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAA;gBACrC,CAAC,CAAC,IAAI,GAAG,OAAO,GAAG,IAAI,CAAA;gBACvB,CAAC,CAAC,QAAQ,GAAG,cAAc,KAAK,GAAG,QAAQ,GAAG,EAAE,OAAO,CAAA;gBACvD,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAA;gBAC5B,CAAC,CAAC,KAAK,EAAE,CAAA;gBACT,CAAC,CAAC,MAAM,EAAE,CAAA;aACX;SACF;QAEO,YAAY;YAClB,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAA;YACxC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;YAC/B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,KAAK;gBAC3B,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,KAAK,CAAA;gBACrB,IAAI,CAAC,QAAQ,GAAG,cAAc,KAAK,MAAM,CAAA;gBACzC,IAAI,CAAC,KAAK,EAAE,CAAA;aACb,CAAC,CAAA;YACF,IAAI,CAAC,MAAM,EAAE,CAAA;SACd;;QAIO,MAAM,CAAC,YAA0B;YACvC,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;YAC3C,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAA;YAElC,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YAC/C,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC,CAAA;YACxC,MAAM,CAAC,SAAS,GAAG,GAAG,CAAA;YACtB,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAExC,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YACnD,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,EAAE,UAAU,CAAC,CAAA;YACvD,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,GAAG,CAAA;YAChC,IAAI,CAAC,WAAW,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAEnD,MAAM,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;YACpD,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAA;YAExC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;YAChD,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,MAAM,CAAA;YAC5B,IAAI,CAAC,SAAS,CAAC,EAAE,GAAG,QAAQ,CAAA;YAC5B,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,kBAAkB,CAAA;YAC1C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAA;YAErC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YACjD,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAA;YAClD,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,mBAAmB,CAAA;YAC9C,IAAI,CAAC,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAE/C,MAAM,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YACxD,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAA;YACnD,eAAe,CAAC,SAAS,GAAG,mBAAmB,CAAA;YAC/C,eAAe,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAA;YAEjE,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YAClD,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAA;YAC7C,SAAS,CAAC,SAAS,GAAG,wBAAwB,CAAA;YAC9C,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAA;YAE5D,MAAM,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YACxD,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,eAAe,CAAC,CAAA;YAC1D,eAAe,CAAC,SAAS,GAAG,eAAe,CAAA;YAC3C,eAAe,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAEtD,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;YAChD,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,MAAM,CAAC,CAAA;YACzC,OAAO,CAAC,SAAS,GAAG,MAAM,CAAA;YAC1B,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAE1C,MAAM,UAAU,GAAqB,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;YACpE,UAAU,CAAC,IAAI,GAAG,OAAO,CAAA;YACzB,UAAU,CAAC,GAAG,GAAG,GAAG,CAAA;YACpB,UAAU,CAAC,GAAG,GAAG,MAAM,CAAA;YACvB,UAAU,CAAC,IAAI,GAAG,KAAK,CAAA;YACvB,UAAU,CAAC,KAAK,GAAG,GAAG,CAAA;YACtB,MAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC5C,UAAU,CAAC,WAAW,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAA;YACvD,UAAU,CAAC,SAAS,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,eAAe,EAAE,CAAA;YACvD,UAAU,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK,UAAU,CAAC,QAAQ,CAAoB,CAAC,CAAC,MAAO,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAA;YAE3F,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;YAC5C,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;YAClC,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACnD,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAEpD,cAAc,CAAC,MAAM,CACnB,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,EACd,OAAO,EACP,UAAU,EACV,eAAe,EACf,eAAe,EACf,SAAS,CACV,CAAA;YACD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,OAAO,EAAE,cAAc,CAAC,CAAA;YAE1E,MAAM,MAAM,GAAG,YAAY,IAAI,QAAQ,CAAC,IAAI,CAAA;YAC5C,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;SAC3B;QAEO,YAAY,CAAC,KAAK;YACxB,MAAM,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAA;YACxC,IAAI,KAAK,EAAE;gBACT,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;oBACnD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAA;iBAC9B;qBAAM,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;oBAC3D,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAA;iBAChC;qBAAM,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;oBAC7D,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,EAAE,QAAQ,EAAE,UAAU,CAAoB,KAAK,CAAC,MAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAA;iBAClG;qBAAM,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;oBACzD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,EAAE,IAAI,EAAsB,KAAK,CAAC,MAAO,CAAC,KAAK,EAAE,CAAC,CAAA;iBACnF;qBAAM,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;oBAC3D,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;iBAClC;qBAAM,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;oBAC7D,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAA;iBACjC;gBACD,IAAI,CAAC,UAAU,EAAE,CAAA;aAClB;SACF;QAEO,QAAQ;YACd,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC/C,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAA;gBACzC,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,GAAG,CAAA;aACjC;iBAAM;gBACL,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAA;gBACtC,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,GAAG,CAAA;aACjC;SACF;QAEO,MAAM;YACZ,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE,CAAA;YAC3B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,KAAK;gBAC3B,MAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;gBACzC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;gBAExB,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;gBAChD,WAAW,CAAC,SAAS,GAAG,GAAG,KAAK,GAAG,CAAC,GAAG,CAAA;gBAEvC,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;gBAC7C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAA;gBAChC,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;gBAC9C,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;gBACtC,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;gBAC5C,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;gBAElC,MAAM,KAAK,GAAG,IAAI,KAAK,EAAE,CAAA;gBACzB,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,KAAK,CAAA;gBAErB,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;gBACrD,aAAa,CAAC,SAAS,GAAG,UAAU,CAAA;gBACpC,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;gBACrD,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;gBAC9C,aAAa,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,EAAE,CAAA;gBACxC,aAAa,CAAC,IAAI,GAAG,QAAQ,CAAA;gBAC7B,aAAa,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;gBAE1C,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;gBACjD,SAAS,CAAC,SAAS,GAAG,QAAQ,CAAA;gBAC9B,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBACnD,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;gBACvC,UAAU,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,EAAE,CAAA;gBACrC,MAAM,OAAO,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC;oBAClC,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;oBAC3C,EAAE,CAAC,SAAS,GAAG,CAAC,CAAA;oBAChB,EAAE,CAAC,KAAK,GAAG,CAAC,CAAA;oBACZ,EAAE,CAAC,QAAQ,GAAG,CAAC,KAAK,GAAG,CAAC,IAAI,CAAA;oBAC5B,OAAO,EAAE,CAAA;iBACV,CAAC,CAAA;gBACF,UAAU,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,CAAA;gBAE7B,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBAClD,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAA;gBACxC,SAAS,CAAC,KAAK,GAAG,QAAQ,CAAA;gBAC1B,SAAS,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,EAAE,CAAA;gBACpC,SAAS,CAAC,SAAS,GAAG,GAAG,CAAA;gBAEzB,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBACjD,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;gBACtC,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAA;gBACxB,QAAQ,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,EAAE,CAAA;gBACnC,QAAQ,CAAC,SAAS,GAAG,QAAQ,CAAA;gBAE7B,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBAClD,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAA;gBACxC,SAAS,CAAC,KAAK,GAAG,SAAS,CAAA;gBAC3B,SAAS,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,EAAE,CAAA;gBACpC,SAAS,CAAC,SAAS,GAAG,QAAQ,CAAA;gBAE9B,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBACpD,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;gBAC5C,WAAW,CAAC,KAAK,GAAG,WAAW,CAAA;gBAC/B,WAAW,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,KAAK,EAAE,CAAA;gBACtC,WAAW,CAAC,SAAS,GAAG,QAAQ,CAAA;gBAEhC,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,WAAW,CAAC,CAAA;gBAC5D,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,aAAa,EAAE,SAAS,EAAE,UAAU,CAAC,CAAA;gBAClE,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAA;gBAC/B,GAAG,CAAC,MAAM,CAAC,WAAW,EAAE,OAAO,EAAE,MAAM,CAAC,CAAA;gBACxC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG,CAAC,CAAA;aAC9B,CAAC,CAAA;SACH;;;;;;;;;;;;;;;;;;;;;;;;"}